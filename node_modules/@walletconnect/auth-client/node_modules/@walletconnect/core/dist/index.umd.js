(function(X,Z){typeof exports=="object"&&typeof module<"u"?Z(exports):typeof define=="function"&&define.amd?define(["exports"],Z):(X=typeof globalThis<"u"?globalThis:X||self,Z(X["@walletconnect/core"]={}))})(this,function(X){"use strict";var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qr(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}function ka(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Za=Qa;function Qa(t,e,r){var i=r&&r.stringify||ka,n=1;if(typeof t=="object"&&t!==null){var o=e.length+n;if(o===1)return t;var u=new Array(o);u[0]=i(t);for(var c=1;c<o;c++)u[c]=i(e[c]);return u.join(" ")}if(typeof t!="string")return t;var f=e.length;if(f===0)return t;for(var d="",g=1-n,D=-1,A=t&&t.length||0,m=0;m<A;){if(t.charCodeAt(m)===37&&m+1<A){switch(D=D>-1?D:0,t.charCodeAt(m+1)){case 100:case 102:if(g>=f||e[g]==null)break;D<m&&(d+=t.slice(D,m)),d+=Number(e[g]),D=m+2,m++;break;case 105:if(g>=f||e[g]==null)break;D<m&&(d+=t.slice(D,m)),d+=Math.floor(Number(e[g])),D=m+2,m++;break;case 79:case 111:case 106:if(g>=f||e[g]===void 0)break;D<m&&(d+=t.slice(D,m));var R=typeof e[g];if(R==="string"){d+="'"+e[g]+"'",D=m+2,m++;break}if(R==="function"){d+=e[g].name||"<anonymous>",D=m+2,m++;break}d+=i(e[g]),D=m+2,m++;break;case 115:if(g>=f)break;D<m&&(d+=t.slice(D,m)),d+=String(e[g]),D=m+2,m++;break;case 37:D<m&&(d+=t.slice(D,m)),d+="%",D=m+2,m++,g--;break}++g}++m}return D===-1?t:(D<A&&(d+=t.slice(D)),d)}var qi=Za,Xi=_t,kt=co().console||{},eo={mapHttpRequest:br,mapHttpResponse:br,wrapRequestSerializer:Jr,wrapResponseSerializer:Jr,wrapErrorSerializer:Jr,req:br,res:br,err:no};function _t(t){t=t||{},t.browser=t.browser||{};var e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");var r=t.browser.write||kt;t.browser.write&&(t.browser.asObject=!0);var i=t.serializers||{},n=Array.isArray(t.browser.serialize)?t.browser.serialize.filter(function(R){return R!=="!stdSerializers.err"}):t.browser.serialize===!0?Object.keys(i):!1,o=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);var u=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");var c=t.level||"info",f=Object.create(r);f.log||(f.log=Zt),Object.defineProperty(f,"levelVal",{get:g}),Object.defineProperty(f,"level",{get:D,set:A});var d={transmit:e,serialize:n,asObject:t.browser.asObject,levels:u,timestamp:so(t)};f.levels=_t.levels,f.level=c,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=Zt,f.serializers=i,f._serialize=n,f._stdErrSerialize=o,f.child=m,e&&(f._logEvent=Xr());function g(){return this.level==="silent"?1/0:this.levels.values[this.level]}function D(){return this._level}function A(R){if(R!=="silent"&&!this.levels.values[R])throw Error("unknown level "+R);this._level=R,zt(d,f,"error","log"),zt(d,f,"fatal","error"),zt(d,f,"warn","error"),zt(d,f,"info","log"),zt(d,f,"debug","log"),zt(d,f,"trace","log")}function m(R){if(!R)throw new Error("missing bindings for child Pino");var j=R.serializers;if(n&&j){var C=Object.assign({},i,j),$=t.browser.serialize===!0?Object.keys(C):n;delete R.serializers,yr([R],$,C,this._stdErrSerialize)}function w(x){this._childLevel=(x._childLevel|0)+1,this.error=Ht(x,R,"error"),this.fatal=Ht(x,R,"fatal"),this.warn=Ht(x,R,"warn"),this.info=Ht(x,R,"info"),this.debug=Ht(x,R,"debug"),this.trace=Ht(x,R,"trace"),C&&(this.serializers=C,this._serialize=$),e&&(this._logEvent=Xr([].concat(x._logEvent.bindings,R)))}return w.prototype=this,new w(this)}return f}_t.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},_t.stdSerializers=eo,_t.stdTimeFunctions=Object.assign({},{nullTime:Ji,epochTime:ki,unixTime:ao,isoTime:oo});function zt(t,e,r,i){var n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Zt:n[r]?n[r]:kt[r]||kt[i]||Zt,to(t,e,r)}function to(t,e,r){!t.transmit&&e[r]===Zt||(e[r]=function(i){return function(){for(var o=t.timestamp(),u=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===kt?kt:this,f=0;f<u.length;f++)u[f]=arguments[f];if(t.serialize&&!t.asObject&&yr(u,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(c,ro(this,r,u,o)):i.apply(c,u),t.transmit){var d=t.transmit.level||e.level,g=_t.levels.values[d],D=_t.levels.values[r];if(D<g)return;io(this,{ts:o,methodLevel:r,methodValue:D,transmitLevel:d,transmitValue:_t.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},u)}}}(e[r]))}function ro(t,e,r,i){t._serialize&&yr(r,t._serialize,t.serializers,t._stdErrSerialize);var n=r.slice(),o=n[0],u={};i&&(u.time=i),u.level=_t.levels.values[e];var c=(t._childLevel|0)+1;if(c<1&&(c=1),o!==null&&typeof o=="object"){for(;c--&&typeof n[0]=="object";)Object.assign(u,n.shift());o=n.length?qi(n.shift(),n):void 0}else typeof o=="string"&&(o=qi(n.shift(),n));return o!==void 0&&(u.msg=o),u}function yr(t,e,r,i){for(var n in t)if(i&&t[n]instanceof Error)t[n]=_t.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(var o in t[n])e&&e.indexOf(o)>-1&&o in r&&(t[n][o]=r[o](t[n][o]))}function Ht(t,e,r){return function(){var i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function io(t,e,r){var i=e.send,n=e.ts,o=e.methodLevel,u=e.methodValue,c=e.val,f=t._logEvent.bindings;yr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(d){return f.indexOf(d)===-1}),t._logEvent.level.label=o,t._logEvent.level.value=u,i(o,t._logEvent,c),t._logEvent=Xr(f)}function Xr(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function no(t){var e={type:t.constructor.name,msg:t.message,stack:t.stack};for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}function so(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Ji:ki}function br(){return{}}function Jr(t){return t}function Zt(){}function Ji(){return!1}function ki(){return Date.now()}function ao(){return Math.round(Date.now()/1e3)}function oo(){return new Date(Date.now()).toISOString()}function co(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}function $e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var pt=$e;$e.EventEmitter=$e,$e.prototype._events=void 0,$e.prototype._maxListeners=void 0,$e.defaultMaxListeners=10,$e.prototype.setMaxListeners=function(t){if(!uo(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},$e.prototype.emit=function(t){var e,r,i,n,o,u;if(this._events||(this._events={}),t==="error"&&(!this._events.error||Qt(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],Zi(r))return!1;if(bt(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n)}else if(Qt(r))for(n=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,o=0;o<i;o++)u[o].apply(this,n);return!0},$e.prototype.addListener=function(t,e){var r;if(!bt(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,bt(e.listener)?e.listener:e),this._events[t]?Qt(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Qt(this._events[t])&&!this._events[t].warned&&(Zi(this._maxListeners)?r=$e.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),typeof console.trace=="function"&&console.trace())),this},$e.prototype.on=$e.prototype.addListener,$e.prototype.once=function(t,e){if(!bt(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},$e.prototype.removeListener=function(t,e){var r,i,n,o;if(!bt(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],n=r.length,i=-1,r===e||bt(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Qt(r)){for(o=n;o-- >0;)if(r[o]===e||r[o].listener&&r[o].listener===e){i=o;break}if(i<0)return this;r.length===1?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},$e.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[t]&&delete this._events[t],this;if(arguments.length===0){for(e in this._events)e!=="removeListener"&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],bt(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},$e.prototype.listeners=function(t){var e;return!this._events||!this._events[t]?e=[]:bt(this._events[t])?e=[this._events[t]]:e=this._events[t].slice(),e},$e.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(bt(e))return 1;if(e)return e.length}return 0},$e.listenerCount=function(t,e){return t.listenerCount(e)};function bt(t){return typeof t=="function"}function uo(t){return typeof t=="number"}function Qt(t){return typeof t=="object"&&t!==null}function Zi(t){return t===void 0}var Er={},kr=function(t,e){return kr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])},kr(t,e)};function fo(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");kr(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Zr=function(){return Zr=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Zr.apply(this,arguments)};function ho(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function lo(t,e,r,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(u=t[c])&&(o=(n<3?u(o):n>3?u(e,r,o):u(e,r))||o);return n>3&&o&&Object.defineProperty(e,r,o),o}function go(t,e){return function(r,i){e(r,i,t)}}function _o(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function po(t,e,r,i){function n(o){return o instanceof r?o:new r(function(u){u(o)})}return new(r||(r=Promise))(function(o,u){function c(g){try{d(i.next(g))}catch(D){u(D)}}function f(g){try{d(i.throw(g))}catch(D){u(D)}}function d(g){g.done?o(g.value):n(g.value).then(c,f)}d((i=i.apply(t,e||[])).next())})}function vo(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,n,o,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(d){return function(g){return f([d,g])}}function f(d){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=d[0]&2?n.return:d[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,d[1])).done)return o;switch(n=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){r.label=d[1];break}if(d[0]===6&&r.label<o[1]){r.label=o[1],o=d;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(d);break}o[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(g){d=[6,g],n=0}finally{i=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Qr=Object.create?function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]};function yo(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Qr(e,t,r)}function ei(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,o=[],u;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(c){u={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(u)throw u.error}}return o}function bo(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Qi(arguments[e]));return t}function Eo(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var o=arguments[e],u=0,c=o.length;u<c;u++,n++)i[n]=o[u];return i}function wo(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,o;i<n;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))}function er(t){return this instanceof er?(this.v=t,this):new er(t)}function mo(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,o=[];return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n;function u(A){i[A]&&(n[A]=function(m){return new Promise(function(R,j){o.push([A,m,R,j])>1||c(A,m)})})}function c(A,m){try{f(i[A](m))}catch(R){D(o[0][3],R)}}function f(A){A.value instanceof er?Promise.resolve(A.value.v).then(d,g):D(o[0][2],A)}function d(A){c("next",A)}function g(A){c("throw",A)}function D(A,m){A(m),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Do(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,o){e[n]=t[n]?function(u){return(r=!r)?{value:er(t[n](u)),done:n==="return"}:o?o(u):u}:o}}function So(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ei=="function"?ei(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(o){r[o]=t[o]&&function(u){return new Promise(function(c,f){u=t[o](u),n(c,f,u.done,u.value)})}}function n(o,u,c,f){Promise.resolve(f).then(function(d){o({value:d,done:c})},u)}}function Oo(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var To=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function xo(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Qr(e,t,r);return To(e,t),e}function Ro(t){return t&&t.__esModule?t:{default:t}}function Io(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function Ao(t,e,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function Co(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}var Lo=Object.freeze({__proto__:null,__extends:fo,get __assign(){return Zr},__rest:ho,__decorate:lo,__param:go,__metadata:_o,__awaiter:po,__generator:vo,__createBinding:Qr,__exportStar:yo,__values:ei,__read:Qi,__spread:bo,__spreadArrays:Eo,__spreadArray:wo,__await:er,__asyncGenerator:mo,__asyncDelegator:Do,__asyncValues:So,__makeTemplateObject:Oo,__importStar:xo,__importDefault:Ro,__classPrivateFieldGet:Io,__classPrivateFieldSet:Ao,__classPrivateFieldIn:Co}),ti=qr(Lo),wr={exports:{}},en;function No(){return en||(en=1,function(){var t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){var r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),Z.localStorage?wr.exports=localStorage:wr.exports=new e}()),wr.exports}var tr={},tn;function rn(){if(tn)return tr;tn=1,Object.defineProperty(tr,"__esModule",{value:!0});function t(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}tr.safeJsonParse=t;function e(r){return typeof r=="string"?r:JSON.stringify(r,(i,n)=>typeof n>"u"?null:n)}return tr.safeJsonStringify=e,tr}var ri={},rr={},nn;function Po(){if(nn)return rr;nn=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.IKeyValueStorage=void 0;class t{}return rr.IKeyValueStorage=t,rr}var ir={},sn;function Uo(){if(sn)return ir;sn=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.parseEntry=void 0;const t=rn();function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return ir.parseEntry=e,ir}var an;function Mo(){return an||(an=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ti;e.__exportStar(Po(),t),e.__exportStar(Uo(),t)}(ri)),ri}Object.defineProperty(Er,"__esModule",{value:!0}),Er.KeyValueStorage=void 0;const $t=ti,jo=$t.__importDefault(No()),on=rn(),Bo=Mo();class cn{constructor(){this.localStorage=jo.default}getKeys(){return $t.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return $t.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Bo.parseEntry)})}getItem(e){return $t.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return on.safeJsonParse(r)})}setItem(e,r){return $t.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,on.safeJsonStringify(r))})}removeItem(e){return $t.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Er.KeyValueStorage=cn;var Fo=Er.default=cn,nr={},mr={},Se={},un={},Dr={};Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.delay=void 0;function zo(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}Dr.delay=zo;var Kt={},ii={},Gt={};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.ONE_THOUSAND=Gt.ONE_HUNDRED=void 0,Gt.ONE_HUNDRED=100,Gt.ONE_THOUSAND=1e3;var fn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365})(fn),function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(Gt,t),r(fn,t)}(ii),Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.fromMiliseconds=Kt.toMiliseconds=void 0;const hn=ii;function Ho(t){return t*hn.ONE_THOUSAND}Kt.toMiliseconds=Ho;function $o(t){return Math.floor(t/hn.ONE_THOUSAND)}Kt.fromMiliseconds=$o,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(Dr,t),r(Kt,t)}(un);var sr={};Object.defineProperty(sr,"__esModule",{value:!0}),sr.Watch=void 0;class ln{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const r=this.get(e);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${e}`);const i=Date.now()-r.started;this.timestamps.set(e,{started:r.started,elapsed:i})}get(e){const r=this.timestamps.get(e);if(typeof r>"u")throw new Error(`No timestamp found for label: ${e}`);return r}elapsed(e){const r=this.get(e);return r.elapsed||Date.now()-r.started}}sr.Watch=ln,sr.default=ln;var dn={},Sr={};Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IWatch=void 0;class Ko{}Sr.IWatch=Ko,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(Sr,t)}(dn),function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(un,t),r(sr,t),r(dn,t),r(ii,t)}(Se);var ni={},Or={};class Lt{}var Go=Object.freeze({__proto__:null,IEvents:Lt}),Vo=qr(Go);Object.defineProperty(Or,"__esModule",{value:!0}),Or.IHeartBeat=void 0;const Yo=Vo;class Wo extends Yo.IEvents{constructor(e){super()}}Or.IHeartBeat=Wo,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(Or,t)}(ni);var si={},Vt={};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.HEARTBEAT_EVENTS=Vt.HEARTBEAT_INTERVAL=void 0;const qo=Se;Vt.HEARTBEAT_INTERVAL=qo.FIVE_SECONDS,Vt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(Vt,t)}(si);var ai=Z&&Z.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(u){u(o)})}return new(r||(r=Promise))(function(o,u){function c(g){try{d(i.next(g))}catch(D){u(D)}}function f(g){try{d(i.throw(g))}catch(D){u(D)}}function d(g){g.done?o(g.value):n(g.value).then(c,f)}d((i=i.apply(t,e||[])).next())})};Object.defineProperty(mr,"__esModule",{value:!0}),mr.HeartBeat=void 0;const Xo=pt,Jo=Se,ko=ni,oi=si;class ci extends ko.IHeartBeat{constructor(e){super(e),this.events=new Xo.EventEmitter,this.interval=oi.HEARTBEAT_INTERVAL,this.interval=e?.interval||oi.HEARTBEAT_INTERVAL}static init(e){return ai(this,void 0,void 0,function*(){const r=new ci(e);return yield r.init(),r})}init(){return ai(this,void 0,void 0,function*(){yield this.initialize()})}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}initialize(){return ai(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),Jo.toMiliseconds(this.interval))})}pulse(){this.events.emit(oi.HEARTBEAT_EVENTS.pulse)}}mr.HeartBeat=ci,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(mr,t),r(ni,t),r(si,t)}(nr);var xe={},Nt={},gn;function _n(){return gn||(gn=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.PINO_CUSTOM_CONTEXT_KEY=Nt.PINO_LOGGER_DEFAULTS=void 0,Nt.PINO_LOGGER_DEFAULTS={level:"info"},Nt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Nt}var rt={},pn;function Zo(){if(pn)return rt;pn=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.generateChildLogger=rt.formatChildLoggerContext=rt.getLoggerContext=rt.setBrowserLoggerContext=rt.getBrowserLoggerContext=rt.getDefaultLoggerOptions=void 0;const t=_n();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}rt.getDefaultLoggerOptions=e;function r(c,f=t.PINO_CUSTOM_CONTEXT_KEY){return c[f]||""}rt.getBrowserLoggerContext=r;function i(c,f,d=t.PINO_CUSTOM_CONTEXT_KEY){return c[d]=f,c}rt.setBrowserLoggerContext=i;function n(c,f=t.PINO_CUSTOM_CONTEXT_KEY){let d="";return typeof c.bindings>"u"?d=r(c,f):d=c.bindings().context||"",d}rt.getLoggerContext=n;function o(c,f,d=t.PINO_CUSTOM_CONTEXT_KEY){const g=n(c,d);return g.trim()?`${g}/${f}`:f}rt.formatChildLoggerContext=o;function u(c,f,d=t.PINO_CUSTOM_CONTEXT_KEY){const g=o(c,f,d),D=c.child({context:g});return i(D,g,d)}return rt.generateChildLogger=u,rt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ti;e.__exportStar(_n(),t),e.__exportStar(Zo(),t)})(xe);class Qo extends Lt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class ec extends Lt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class tc{constructor(e,r){this.logger=e,this.core=r}}class rc extends Lt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class ic extends Lt{constructor(e){super()}}class nc{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class sc extends Lt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class ac extends Lt{constructor(e,r){super(),this.core=e,this.logger=r}}function Ke(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var oc=Ke;Ke.EventEmitter=Ke,Ke.prototype._events=void 0,Ke.prototype._maxListeners=void 0,Ke.defaultMaxListeners=10,Ke.prototype.setMaxListeners=function(t){if(!cc(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},Ke.prototype.emit=function(t){var e,r,i,n,o,u;if(this._events||(this._events={}),t==="error"&&(!this._events.error||ar(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],vn(r))return!1;if(Et(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n)}else if(ar(r))for(n=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,o=0;o<i;o++)u[o].apply(this,n);return!0},Ke.prototype.addListener=function(t,e){var r;if(!Et(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Et(e.listener)?e.listener:e),this._events[t]?ar(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,ar(this._events[t])&&!this._events[t].warned&&(vn(this._maxListeners)?r=Ke.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),typeof console.trace=="function"&&console.trace())),this},Ke.prototype.on=Ke.prototype.addListener,Ke.prototype.once=function(t,e){if(!Et(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},Ke.prototype.removeListener=function(t,e){var r,i,n,o;if(!Et(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],n=r.length,i=-1,r===e||Et(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(ar(r)){for(o=n;o-- >0;)if(r[o]===e||r[o].listener&&r[o].listener===e){i=o;break}if(i<0)return this;r.length===1?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},Ke.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[t]&&delete this._events[t],this;if(arguments.length===0){for(e in this._events)e!=="removeListener"&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],Et(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},Ke.prototype.listeners=function(t){var e;return!this._events||!this._events[t]?e=[]:Et(this._events[t])?e=[this._events[t]]:e=this._events[t].slice(),e},Ke.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(Et(e))return 1;if(e)return e.length}return 0},Ke.listenerCount=function(t,e){return t.listenerCount(e)};function Et(t){return typeof t=="function"}function cc(t){return typeof t=="number"}function ar(t){return typeof t=="object"&&t!==null}function vn(t){return t===void 0}class Ld extends oc.EventEmitter{constructor(){super()}}function yn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function ui(t){return typeof t=="string"?t:JSON.stringify(t)}var fi={},bn={},Tr={},xr={};Object.defineProperty(xr,"__esModule",{value:!0}),xr.BrowserRandomSource=void 0;const En=65536;class uc{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=En)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,En)));return r}}xr.BrowserRandomSource=uc;function wn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Rr={},it={};Object.defineProperty(it,"__esModule",{value:!0});function fc(t){for(var e=0;e<t.length;e++)t[e]=0;return t}it.wipe=fc;var hc={},lc=Object.freeze({__proto__:null,default:hc}),mn=qr(lc);Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.NodeRandomSource=void 0;const dc=it;class gc{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof wn<"u"){const e=mn;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,dc.wipe)(r),i}}Rr.NodeRandomSource=gc,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.SystemRandomSource=void 0;const _c=xr,pc=Rr;class vc{constructor(){if(this.isAvailable=!1,this.name="",this._source=new _c.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new pc.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Tr.SystemRandomSource=vc;var ee={},Dn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,f){var d=c>>>16&65535,g=c&65535,D=f>>>16&65535,A=f&65535;return g*A+(d*A+g*D<<16>>>0)|0}t.mul=Math.imul||e;function r(c,f){return c+f|0}t.add=r;function i(c,f){return c-f|0}t.sub=i;function n(c,f){return c<<f|c>>>32-f}t.rotl=n;function o(c,f){return c<<32-f|c>>>f}t.rotr=o;function u(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||u,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Dn),Object.defineProperty(ee,"__esModule",{value:!0});var Sn=Dn;function yc(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ee.readInt16BE=yc;function bc(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ee.readUint16BE=bc;function Ec(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ee.readInt16LE=Ec;function wc(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ee.readUint16LE=wc;function On(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ee.writeUint16BE=On,ee.writeInt16BE=On;function Tn(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ee.writeUint16LE=Tn,ee.writeInt16LE=Tn;function hi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ee.readInt32BE=hi;function li(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ee.readUint32BE=li;function di(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ee.readInt32LE=di;function gi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ee.readUint32LE=gi;function Ir(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ee.writeUint32BE=Ir,ee.writeInt32BE=Ir;function Ar(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ee.writeUint32LE=Ar,ee.writeInt32LE=Ar;function mc(t,e){e===void 0&&(e=0);var r=hi(t,e),i=hi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ee.readInt64BE=mc;function Dc(t,e){e===void 0&&(e=0);var r=li(t,e),i=li(t,e+4);return r*4294967296+i}ee.readUint64BE=Dc;function Sc(t,e){e===void 0&&(e=0);var r=di(t,e),i=di(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ee.readInt64LE=Sc;function Oc(t,e){e===void 0&&(e=0);var r=gi(t,e),i=gi(t,e+4);return i*4294967296+r}ee.readUint64LE=Oc;function xn(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ir(t/4294967296>>>0,e,r),Ir(t>>>0,e,r+4),e}ee.writeUint64BE=xn,ee.writeInt64BE=xn;function Rn(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ar(t>>>0,e,r),Ar(t/4294967296>>>0,e,r+4),e}ee.writeUint64LE=Rn,ee.writeInt64LE=Rn;function Tc(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,o=t/8+r-1;o>=r;o--)i+=e[o]*n,n*=256;return i}ee.readUintBE=Tc;function xc(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,o=r;o<r+t/8;o++)i+=e[o]*n,n*=256;return i}ee.readUintLE=xc;function Rc(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Sn.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,o=t/8+i-1;o>=i;o--)r[o]=e/n&255,n*=256;return r}ee.writeUintBE=Rc;function Ic(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Sn.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,o=i;o<i+t/8;o++)r[o]=e/n&255,n*=256;return r}ee.writeUintLE=Ic;function Ac(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ee.readFloat32BE=Ac;function Cc(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ee.readFloat32LE=Cc;function Lc(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ee.readFloat64BE=Lc;function Nc(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ee.readFloat64LE=Nc;function Pc(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ee.writeFloat32BE=Pc;function Uc(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ee.writeFloat32LE=Uc;function Mc(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ee.writeFloat64BE=Mc;function jc(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ee.writeFloat64LE=jc,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Tr,r=ee,i=it;t.defaultRandomSource=new e.SystemRandomSource;function n(d,g=t.defaultRandomSource){return g.randomBytes(d)}t.randomBytes=n;function o(d=t.defaultRandomSource){const g=n(4,d),D=(0,r.readUint32LE)(g);return(0,i.wipe)(g),D}t.randomUint32=o;const u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(d,g=u,D=t.defaultRandomSource){if(g.length<2)throw new Error("randomString charset is too short");if(g.length>256)throw new Error("randomString charset is too long");let A="";const m=g.length,R=256-256%m;for(;d>0;){const j=n(Math.ceil(d*256/R),D);for(let C=0;C<j.length&&d>0;C++){const $=j[C];$<R&&(A+=g.charAt($%m),d--)}(0,i.wipe)(j)}return A}t.randomString=c;function f(d,g=u,D=t.defaultRandomSource){const A=Math.ceil(d/(Math.log(g.length)/Math.LN2));return c(A,g,D)}t.randomStringForEntropy=f}(bn);var In={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ee,r=it;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(f,d){if(d===void 0&&(d=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var g=0;if(this._bytesHashed+=d,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&d>0;)this._buffer[this._bufferLength++]=f[g++],d--;this._bufferLength===this.blockSize&&(o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(d>=this.blockSize&&(g=o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,g,d),d%=this.blockSize);d>0;)this._buffer[this._bufferLength++]=f[g++],d--;return this},c.prototype.finish=function(f){if(!this._finished){var d=this._bytesHashed,g=this._bufferLength,D=d/536870912|0,A=d<<3,m=d%128<112?128:256;this._buffer[g]=128;for(var R=g+1;R<m-8;R++)this._buffer[R]=0;e.writeUint32BE(D,this._buffer,m-8),e.writeUint32BE(A,this._buffer,m-4),o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,m),this._finished=!0}for(var R=0;R<this.digestLength/8;R++)e.writeUint32BE(this._stateHi[R],f,R*8),e.writeUint32BE(this._stateLo[R],f,R*8+4);return this},c.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(f){r.wipe(f.stateHi),r.wipe(f.stateLo),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},c}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function o(c,f,d,g,D,A,m){for(var R=d[0],j=d[1],C=d[2],$=d[3],w=d[4],x=d[5],p=d[6],y=d[7],v=g[0],s=g[1],l=g[2],U=g[3],H=g[4],q=g[5],J=g[6],k=g[7],S,I,G,Y,N,P,M,B;m>=128;){for(var ie=0;ie<16;ie++){var F=8*ie+A;c[ie]=e.readUint32BE(D,F),f[ie]=e.readUint32BE(D,F+4)}for(var ie=0;ie<80;ie++){var Q=R,W=j,oe=C,T=$,O=w,b=x,a=p,_=y,z=v,K=s,he=l,ve=U,de=H,Ee=q,Ue=J,Ce=k;if(S=y,I=k,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=(w>>>14|H<<32-14)^(w>>>18|H<<32-18)^(H>>>41-32|w<<32-(41-32)),I=(H>>>14|w<<32-14)^(H>>>18|w<<32-18)^(w>>>41-32|H<<32-(41-32)),N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,S=w&x^~w&p,I=H&q^~H&J,N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,S=n[ie*2],I=n[ie*2+1],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,S=c[ie%16],I=f[ie%16],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,G=M&65535|B<<16,Y=N&65535|P<<16,S=G,I=Y,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=(R>>>28|v<<32-28)^(v>>>34-32|R<<32-(34-32))^(v>>>39-32|R<<32-(39-32)),I=(v>>>28|R<<32-28)^(R>>>34-32|v<<32-(34-32))^(R>>>39-32|v<<32-(39-32)),N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,S=R&j^R&C^j&C,I=v&s^v&l^s&l,N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,_=M&65535|B<<16,Ce=N&65535|P<<16,S=T,I=ve,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=G,I=Y,N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,T=M&65535|B<<16,ve=N&65535|P<<16,j=Q,C=W,$=oe,w=T,x=O,p=b,y=a,R=_,s=z,l=K,U=he,H=ve,q=de,J=Ee,k=Ue,v=Ce,ie%16===15)for(var F=0;F<16;F++)S=c[F],I=f[F],N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=c[(F+9)%16],I=f[(F+9)%16],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,G=c[(F+1)%16],Y=f[(F+1)%16],S=(G>>>1|Y<<32-1)^(G>>>8|Y<<32-8)^G>>>7,I=(Y>>>1|G<<32-1)^(Y>>>8|G<<32-8)^(Y>>>7|G<<32-7),N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,G=c[(F+14)%16],Y=f[(F+14)%16],S=(G>>>19|Y<<32-19)^(Y>>>61-32|G<<32-(61-32))^G>>>6,I=(Y>>>19|G<<32-19)^(G>>>61-32|Y<<32-(61-32))^(Y>>>6|G<<32-6),N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,c[F]=M&65535|B<<16,f[F]=N&65535|P<<16}S=R,I=v,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[0],I=g[0],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[0]=R=M&65535|B<<16,g[0]=v=N&65535|P<<16,S=j,I=s,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[1],I=g[1],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[1]=j=M&65535|B<<16,g[1]=s=N&65535|P<<16,S=C,I=l,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[2],I=g[2],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[2]=C=M&65535|B<<16,g[2]=l=N&65535|P<<16,S=$,I=U,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[3],I=g[3],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[3]=$=M&65535|B<<16,g[3]=U=N&65535|P<<16,S=w,I=H,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[4],I=g[4],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[4]=w=M&65535|B<<16,g[4]=H=N&65535|P<<16,S=x,I=q,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[5],I=g[5],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[5]=x=M&65535|B<<16,g[5]=q=N&65535|P<<16,S=p,I=J,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[6],I=g[6],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[6]=p=M&65535|B<<16,g[6]=J=N&65535|P<<16,S=y,I=k,N=I&65535,P=I>>>16,M=S&65535,B=S>>>16,S=d[7],I=g[7],N+=I&65535,P+=I>>>16,M+=S&65535,B+=S>>>16,P+=N>>>16,M+=P>>>16,B+=M>>>16,d[7]=y=M&65535|B<<16,g[7]=k=N&65535|P<<16,A+=128,m-=128}return A}function u(c){var f=new i;f.update(c);var d=f.digest();return f.clean(),d}t.hash=u})(In),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=bn,r=In,i=it;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(T){const O=new Float64Array(16);if(T)for(let b=0;b<T.length;b++)O[b]=T[b];return O}const o=new Uint8Array(32);o[0]=9;const u=n(),c=n([1]),f=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),g=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function m(T,O){for(let b=0;b<16;b++)T[b]=O[b]|0}function R(T){let O=1;for(let b=0;b<16;b++){let a=T[b]+O+65535;O=Math.floor(a/65536),T[b]=a-O*65536}T[0]+=O-1+37*(O-1)}function j(T,O,b){const a=~(b-1);for(let _=0;_<16;_++){const z=a&(T[_]^O[_]);T[_]^=z,O[_]^=z}}function C(T,O){const b=n(),a=n();for(let _=0;_<16;_++)a[_]=O[_];R(a),R(a),R(a);for(let _=0;_<2;_++){b[0]=a[0]-65517;for(let K=1;K<15;K++)b[K]=a[K]-65535-(b[K-1]>>16&1),b[K-1]&=65535;b[15]=a[15]-32767-(b[14]>>16&1);const z=b[15]>>16&1;b[14]&=65535,j(a,b,1-z)}for(let _=0;_<16;_++)T[2*_]=a[_]&255,T[2*_+1]=a[_]>>8}function $(T,O){let b=0;for(let a=0;a<32;a++)b|=T[a]^O[a];return(1&b-1>>>8)-1}function w(T,O){const b=new Uint8Array(32),a=new Uint8Array(32);return C(b,T),C(a,O),$(b,a)}function x(T){const O=new Uint8Array(32);return C(O,T),O[0]&1}function p(T,O){for(let b=0;b<16;b++)T[b]=O[2*b]+(O[2*b+1]<<8);T[15]&=32767}function y(T,O,b){for(let a=0;a<16;a++)T[a]=O[a]+b[a]}function v(T,O,b){for(let a=0;a<16;a++)T[a]=O[a]-b[a]}function s(T,O,b){let a,_,z=0,K=0,he=0,ve=0,de=0,Ee=0,Ue=0,Ce=0,pe=0,ge=0,le=0,ue=0,ce=0,ae=0,se=0,te=0,fe=0,_e=0,re=0,ye=0,be=0,me=0,De=0,we=0,dt=0,yt=0,Rt=0,ot=0,Mt=0,_r=0,Hr=0,Me=b[0],Le=b[1],je=b[2],Be=b[3],Fe=b[4],Ne=b[5],Ge=b[6],Ve=b[7],Ye=b[8],We=b[9],qe=b[10],He=b[11],ze=b[12],Ie=b[13],Xe=b[14],Je=b[15];a=O[0],z+=a*Me,K+=a*Le,he+=a*je,ve+=a*Be,de+=a*Fe,Ee+=a*Ne,Ue+=a*Ge,Ce+=a*Ve,pe+=a*Ye,ge+=a*We,le+=a*qe,ue+=a*He,ce+=a*ze,ae+=a*Ie,se+=a*Xe,te+=a*Je,a=O[1],K+=a*Me,he+=a*Le,ve+=a*je,de+=a*Be,Ee+=a*Fe,Ue+=a*Ne,Ce+=a*Ge,pe+=a*Ve,ge+=a*Ye,le+=a*We,ue+=a*qe,ce+=a*He,ae+=a*ze,se+=a*Ie,te+=a*Xe,fe+=a*Je,a=O[2],he+=a*Me,ve+=a*Le,de+=a*je,Ee+=a*Be,Ue+=a*Fe,Ce+=a*Ne,pe+=a*Ge,ge+=a*Ve,le+=a*Ye,ue+=a*We,ce+=a*qe,ae+=a*He,se+=a*ze,te+=a*Ie,fe+=a*Xe,_e+=a*Je,a=O[3],ve+=a*Me,de+=a*Le,Ee+=a*je,Ue+=a*Be,Ce+=a*Fe,pe+=a*Ne,ge+=a*Ge,le+=a*Ve,ue+=a*Ye,ce+=a*We,ae+=a*qe,se+=a*He,te+=a*ze,fe+=a*Ie,_e+=a*Xe,re+=a*Je,a=O[4],de+=a*Me,Ee+=a*Le,Ue+=a*je,Ce+=a*Be,pe+=a*Fe,ge+=a*Ne,le+=a*Ge,ue+=a*Ve,ce+=a*Ye,ae+=a*We,se+=a*qe,te+=a*He,fe+=a*ze,_e+=a*Ie,re+=a*Xe,ye+=a*Je,a=O[5],Ee+=a*Me,Ue+=a*Le,Ce+=a*je,pe+=a*Be,ge+=a*Fe,le+=a*Ne,ue+=a*Ge,ce+=a*Ve,ae+=a*Ye,se+=a*We,te+=a*qe,fe+=a*He,_e+=a*ze,re+=a*Ie,ye+=a*Xe,be+=a*Je,a=O[6],Ue+=a*Me,Ce+=a*Le,pe+=a*je,ge+=a*Be,le+=a*Fe,ue+=a*Ne,ce+=a*Ge,ae+=a*Ve,se+=a*Ye,te+=a*We,fe+=a*qe,_e+=a*He,re+=a*ze,ye+=a*Ie,be+=a*Xe,me+=a*Je,a=O[7],Ce+=a*Me,pe+=a*Le,ge+=a*je,le+=a*Be,ue+=a*Fe,ce+=a*Ne,ae+=a*Ge,se+=a*Ve,te+=a*Ye,fe+=a*We,_e+=a*qe,re+=a*He,ye+=a*ze,be+=a*Ie,me+=a*Xe,De+=a*Je,a=O[8],pe+=a*Me,ge+=a*Le,le+=a*je,ue+=a*Be,ce+=a*Fe,ae+=a*Ne,se+=a*Ge,te+=a*Ve,fe+=a*Ye,_e+=a*We,re+=a*qe,ye+=a*He,be+=a*ze,me+=a*Ie,De+=a*Xe,we+=a*Je,a=O[9],ge+=a*Me,le+=a*Le,ue+=a*je,ce+=a*Be,ae+=a*Fe,se+=a*Ne,te+=a*Ge,fe+=a*Ve,_e+=a*Ye,re+=a*We,ye+=a*qe,be+=a*He,me+=a*ze,De+=a*Ie,we+=a*Xe,dt+=a*Je,a=O[10],le+=a*Me,ue+=a*Le,ce+=a*je,ae+=a*Be,se+=a*Fe,te+=a*Ne,fe+=a*Ge,_e+=a*Ve,re+=a*Ye,ye+=a*We,be+=a*qe,me+=a*He,De+=a*ze,we+=a*Ie,dt+=a*Xe,yt+=a*Je,a=O[11],ue+=a*Me,ce+=a*Le,ae+=a*je,se+=a*Be,te+=a*Fe,fe+=a*Ne,_e+=a*Ge,re+=a*Ve,ye+=a*Ye,be+=a*We,me+=a*qe,De+=a*He,we+=a*ze,dt+=a*Ie,yt+=a*Xe,Rt+=a*Je,a=O[12],ce+=a*Me,ae+=a*Le,se+=a*je,te+=a*Be,fe+=a*Fe,_e+=a*Ne,re+=a*Ge,ye+=a*Ve,be+=a*Ye,me+=a*We,De+=a*qe,we+=a*He,dt+=a*ze,yt+=a*Ie,Rt+=a*Xe,ot+=a*Je,a=O[13],ae+=a*Me,se+=a*Le,te+=a*je,fe+=a*Be,_e+=a*Fe,re+=a*Ne,ye+=a*Ge,be+=a*Ve,me+=a*Ye,De+=a*We,we+=a*qe,dt+=a*He,yt+=a*ze,Rt+=a*Ie,ot+=a*Xe,Mt+=a*Je,a=O[14],se+=a*Me,te+=a*Le,fe+=a*je,_e+=a*Be,re+=a*Fe,ye+=a*Ne,be+=a*Ge,me+=a*Ve,De+=a*Ye,we+=a*We,dt+=a*qe,yt+=a*He,Rt+=a*ze,ot+=a*Ie,Mt+=a*Xe,_r+=a*Je,a=O[15],te+=a*Me,fe+=a*Le,_e+=a*je,re+=a*Be,ye+=a*Fe,be+=a*Ne,me+=a*Ge,De+=a*Ve,we+=a*Ye,dt+=a*We,yt+=a*qe,Rt+=a*He,ot+=a*ze,Mt+=a*Ie,_r+=a*Xe,Hr+=a*Je,z+=38*fe,K+=38*_e,he+=38*re,ve+=38*ye,de+=38*be,Ee+=38*me,Ue+=38*De,Ce+=38*we,pe+=38*dt,ge+=38*yt,le+=38*Rt,ue+=38*ot,ce+=38*Mt,ae+=38*_r,se+=38*Hr,_=1,a=z+_+65535,_=Math.floor(a/65536),z=a-_*65536,a=K+_+65535,_=Math.floor(a/65536),K=a-_*65536,a=he+_+65535,_=Math.floor(a/65536),he=a-_*65536,a=ve+_+65535,_=Math.floor(a/65536),ve=a-_*65536,a=de+_+65535,_=Math.floor(a/65536),de=a-_*65536,a=Ee+_+65535,_=Math.floor(a/65536),Ee=a-_*65536,a=Ue+_+65535,_=Math.floor(a/65536),Ue=a-_*65536,a=Ce+_+65535,_=Math.floor(a/65536),Ce=a-_*65536,a=pe+_+65535,_=Math.floor(a/65536),pe=a-_*65536,a=ge+_+65535,_=Math.floor(a/65536),ge=a-_*65536,a=le+_+65535,_=Math.floor(a/65536),le=a-_*65536,a=ue+_+65535,_=Math.floor(a/65536),ue=a-_*65536,a=ce+_+65535,_=Math.floor(a/65536),ce=a-_*65536,a=ae+_+65535,_=Math.floor(a/65536),ae=a-_*65536,a=se+_+65535,_=Math.floor(a/65536),se=a-_*65536,a=te+_+65535,_=Math.floor(a/65536),te=a-_*65536,z+=_-1+37*(_-1),_=1,a=z+_+65535,_=Math.floor(a/65536),z=a-_*65536,a=K+_+65535,_=Math.floor(a/65536),K=a-_*65536,a=he+_+65535,_=Math.floor(a/65536),he=a-_*65536,a=ve+_+65535,_=Math.floor(a/65536),ve=a-_*65536,a=de+_+65535,_=Math.floor(a/65536),de=a-_*65536,a=Ee+_+65535,_=Math.floor(a/65536),Ee=a-_*65536,a=Ue+_+65535,_=Math.floor(a/65536),Ue=a-_*65536,a=Ce+_+65535,_=Math.floor(a/65536),Ce=a-_*65536,a=pe+_+65535,_=Math.floor(a/65536),pe=a-_*65536,a=ge+_+65535,_=Math.floor(a/65536),ge=a-_*65536,a=le+_+65535,_=Math.floor(a/65536),le=a-_*65536,a=ue+_+65535,_=Math.floor(a/65536),ue=a-_*65536,a=ce+_+65535,_=Math.floor(a/65536),ce=a-_*65536,a=ae+_+65535,_=Math.floor(a/65536),ae=a-_*65536,a=se+_+65535,_=Math.floor(a/65536),se=a-_*65536,a=te+_+65535,_=Math.floor(a/65536),te=a-_*65536,z+=_-1+37*(_-1),T[0]=z,T[1]=K,T[2]=he,T[3]=ve,T[4]=de,T[5]=Ee,T[6]=Ue,T[7]=Ce,T[8]=pe,T[9]=ge,T[10]=le,T[11]=ue,T[12]=ce,T[13]=ae,T[14]=se,T[15]=te}function l(T,O){s(T,O,O)}function U(T,O){const b=n();let a;for(a=0;a<16;a++)b[a]=O[a];for(a=253;a>=0;a--)l(b,b),a!==2&&a!==4&&s(b,b,O);for(a=0;a<16;a++)T[a]=b[a]}function H(T,O){const b=n();let a;for(a=0;a<16;a++)b[a]=O[a];for(a=250;a>=0;a--)l(b,b),a!==1&&s(b,b,O);for(a=0;a<16;a++)T[a]=b[a]}function q(T,O){const b=n(),a=n(),_=n(),z=n(),K=n(),he=n(),ve=n(),de=n(),Ee=n();v(b,T[1],T[0]),v(Ee,O[1],O[0]),s(b,b,Ee),y(a,T[0],T[1]),y(Ee,O[0],O[1]),s(a,a,Ee),s(_,T[3],O[3]),s(_,_,d),s(z,T[2],O[2]),y(z,z,z),v(K,a,b),v(he,z,_),y(ve,z,_),y(de,a,b),s(T[0],K,he),s(T[1],de,ve),s(T[2],ve,he),s(T[3],K,de)}function J(T,O,b){for(let a=0;a<4;a++)j(T[a],O[a],b)}function k(T,O){const b=n(),a=n(),_=n();U(_,O[2]),s(b,O[0],_),s(a,O[1],_),C(T,a),T[31]^=x(b)<<7}function S(T,O,b){m(T[0],u),m(T[1],c),m(T[2],c),m(T[3],u);for(let a=255;a>=0;--a){const _=b[a/8|0]>>(a&7)&1;J(T,O,_),q(O,T),q(T,T),J(T,O,_)}}function I(T,O){const b=[n(),n(),n(),n()];m(b[0],g),m(b[1],D),m(b[2],c),s(b[3],g,D),S(T,b,O)}function G(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const O=(0,r.hash)(T);O[0]&=248,O[31]&=127,O[31]|=64;const b=new Uint8Array(32),a=[n(),n(),n(),n()];I(a,O),k(b,a);const _=new Uint8Array(64);return _.set(T),_.set(b,32),{publicKey:b,secretKey:_}}t.generateKeyPairFromSeed=G;function Y(T){const O=(0,e.randomBytes)(32,T),b=G(O);return(0,i.wipe)(O),b}t.generateKeyPair=Y;function N(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=N;const P=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(T,O){let b,a,_,z;for(a=63;a>=32;--a){for(b=0,_=a-32,z=a-12;_<z;++_)O[_]+=b-16*O[a]*P[_-(a-32)],b=Math.floor((O[_]+128)/256),O[_]-=b*256;O[_]+=b,O[a]=0}for(b=0,_=0;_<32;_++)O[_]+=b-(O[31]>>4)*P[_],b=O[_]>>8,O[_]&=255;for(_=0;_<32;_++)O[_]-=b*P[_];for(a=0;a<32;a++)O[a+1]+=O[a]>>8,T[a]=O[a]&255}function B(T){const O=new Float64Array(64);for(let b=0;b<64;b++)O[b]=T[b];for(let b=0;b<64;b++)T[b]=0;M(T,O)}function ie(T,O){const b=new Float64Array(64),a=[n(),n(),n(),n()],_=(0,r.hash)(T.subarray(0,32));_[0]&=248,_[31]&=127,_[31]|=64;const z=new Uint8Array(64);z.set(_.subarray(32),32);const K=new r.SHA512;K.update(z.subarray(32)),K.update(O);const he=K.digest();K.clean(),B(he),I(a,he),k(z,a),K.reset(),K.update(z.subarray(0,32)),K.update(T.subarray(32)),K.update(O);const ve=K.digest();B(ve);for(let de=0;de<32;de++)b[de]=he[de];for(let de=0;de<32;de++)for(let Ee=0;Ee<32;Ee++)b[de+Ee]+=ve[de]*_[Ee];return M(z.subarray(32),b),z}t.sign=ie;function F(T,O){const b=n(),a=n(),_=n(),z=n(),K=n(),he=n(),ve=n();return m(T[2],c),p(T[1],O),l(_,T[1]),s(z,_,f),v(_,_,T[2]),y(z,T[2],z),l(K,z),l(he,K),s(ve,he,K),s(b,ve,_),s(b,b,z),H(b,b),s(b,b,_),s(b,b,z),s(b,b,z),s(T[0],b,z),l(a,T[0]),s(a,a,z),w(a,_)&&s(T[0],T[0],A),l(a,T[0]),s(a,a,z),w(a,_)?-1:(x(T[0])===O[31]>>7&&v(T[0],u,T[0]),s(T[3],T[0],T[1]),0)}function Q(T,O,b){const a=new Uint8Array(32),_=[n(),n(),n(),n()],z=[n(),n(),n(),n()];if(b.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(F(z,T))return!1;const K=new r.SHA512;K.update(b.subarray(0,32)),K.update(T),K.update(O);const he=K.digest();return B(he),S(_,z,he),I(z,b.subarray(32)),q(_,z),k(a,_),!$(b,a)}t.verify=Q;function W(T){let O=[n(),n(),n(),n()];if(F(O,T))throw new Error("Ed25519: invalid public key");let b=n(),a=n(),_=O[1];y(b,c,_),v(a,c,_),U(a,a),s(b,b,a);let z=new Uint8Array(32);return C(z,b),z}t.convertPublicKeyToX25519=W;function oe(T){const O=(0,r.hash)(T.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const b=new Uint8Array(O.subarray(0,32));return(0,i.wipe)(O),b}t.convertSecretKeyToX25519=oe}(fi);var or={},_i={},pi={};Object.defineProperty(pi,"__esModule",{value:!0});var An=65536,Bc=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),i=0;i<r.length;i+=An)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,An)));return r},t}();pi.BrowserRandomSource=Bc;var vi={};Object.defineProperty(vi,"__esModule",{value:!0});var Fc=it,zc=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof wn<"u"){var e=mn;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=r[n];return Fc.wipe(r),i},t}();vi.NodeRandomSource=zc,Object.defineProperty(_i,"__esModule",{value:!0});var Hc=pi,$c=vi,Kc=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new Hc.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new $c.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();_i.SystemRandomSource=Kc,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=_i,r=ee,i=it;t.defaultRandomSource=new e.SystemRandomSource;function n(d,g){return g===void 0&&(g=t.defaultRandomSource),g.randomBytes(d)}t.randomBytes=n;function o(d){d===void 0&&(d=t.defaultRandomSource);var g=n(4,d),D=r.readUint32LE(g);return i.wipe(g),D}t.randomUint32=o;var u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(d,g,D){if(g===void 0&&(g=u),D===void 0&&(D=t.defaultRandomSource),g.length<2)throw new Error("randomString charset is too short");if(g.length>256)throw new Error("randomString charset is too long");for(var A="",m=g.length,R=256-256%m;d>0;){for(var j=n(Math.ceil(d*256/R),D),C=0;C<j.length&&d>0;C++){var $=j[C];$<R&&(A+=g.charAt($%m),d--)}i.wipe(j)}return A}t.randomString=c;function f(d,g,D){g===void 0&&(g=u),D===void 0&&(D=t.defaultRandomSource);var A=Math.ceil(d/(Math.log(g.length)/Math.LN2));return c(A,g,D)}t.randomStringForEntropy=f}(or);const Gc="EdDSA",Vc="JWT",Cn=".",Ln="base64url",Yc="utf8",Wc="utf8",qc=":",Xc="did",Jc="key",Nn="base58btc",kc="z",Zc="K36",Qc=32;function Pn(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function yi(t,e){e||(e=t.reduce((n,o)=>n+o.length,0));const r=Pn(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function eu(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var o=t.charAt(n),u=o.charCodeAt(0);if(r[u]!==255)throw new TypeError(o+" is ambiguous");r[u]=n}var c=t.length,f=t.charAt(0),d=Math.log(c)/Math.log(256),g=Math.log(256)/Math.log(c);function D(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var j=0,C=0,$=0,w=R.length;$!==w&&R[$]===0;)$++,j++;for(var x=(w-$)*g+1>>>0,p=new Uint8Array(x);$!==w;){for(var y=R[$],v=0,s=x-1;(y!==0||v<C)&&s!==-1;s--,v++)y+=256*p[s]>>>0,p[s]=y%c>>>0,y=y/c>>>0;if(y!==0)throw new Error("Non-zero carry");C=v,$++}for(var l=x-C;l!==x&&p[l]===0;)l++;for(var U=f.repeat(j);l<x;++l)U+=t.charAt(p[l]);return U}function A(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var j=0;if(R[j]!==" "){for(var C=0,$=0;R[j]===f;)C++,j++;for(var w=(R.length-j)*d+1>>>0,x=new Uint8Array(w);R[j];){var p=r[R.charCodeAt(j)];if(p===255)return;for(var y=0,v=w-1;(p!==0||y<$)&&v!==-1;v--,y++)p+=c*x[v]>>>0,x[v]=p%256>>>0,p=p/256>>>0;if(p!==0)throw new Error("Non-zero carry");$=y,j++}if(R[j]!==" "){for(var s=w-$;s!==w&&x[s]===0;)s++;for(var l=new Uint8Array(C+(w-s)),U=C;s!==w;)l[U++]=x[s++];return l}}}function m(R){var j=A(R);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:A,decode:m}}var tu=eu,ru=tu;const Un=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},iu=t=>new TextEncoder().encode(t),nu=t=>new TextDecoder().decode(t);class su{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class au{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Mn(this,e)}}class ou{constructor(e){this.decoders=e}or(e){return Mn(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Mn=(t,e)=>new ou({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class cu{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new su(e,r,i),this.decoder=new au(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Cr=({name:t,prefix:e,encode:r,decode:i})=>new cu(t,e,r,i),cr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=ru(r,e);return Cr({prefix:t,name:e,encode:i,decode:o=>Un(n(o))})},uu=(t,e,r,i)=>{const n={};for(let g=0;g<e.length;++g)n[e[g]]=g;let o=t.length;for(;t[o-1]==="=";)--o;const u=new Uint8Array(o*r/8|0);let c=0,f=0,d=0;for(let g=0;g<o;++g){const D=n[t[g]];if(D===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|D,c+=r,c>=8&&(c-=8,u[d++]=255&f>>c)}if(c>=r||255&f<<8-c)throw new SyntaxError("Unexpected end of data");return u},fu=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let o="",u=0,c=0;for(let f=0;f<t.length;++f)for(c=c<<8|t[f],u+=8;u>r;)u-=r,o+=e[n&c>>u];if(u&&(o+=e[n&c<<r-u]),i)for(;o.length*r&7;)o+="=";return o},Ze=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Cr({prefix:e,name:t,encode(n){return fu(n,i,r)},decode(n){return uu(n,i,r,t)}}),hu=Cr({prefix:"\0",name:"identity",encode:t=>nu(t),decode:t=>iu(t)});var lu=Object.freeze({__proto__:null,identity:hu});const du=Ze({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var gu=Object.freeze({__proto__:null,base2:du});const _u=Ze({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var pu=Object.freeze({__proto__:null,base8:_u});const vu=cr({prefix:"9",name:"base10",alphabet:"0123456789"});var yu=Object.freeze({__proto__:null,base10:vu});const bu=Ze({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Eu=Ze({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var wu=Object.freeze({__proto__:null,base16:bu,base16upper:Eu});const mu=Ze({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Du=Ze({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Su=Ze({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ou=Ze({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Tu=Ze({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),xu=Ze({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ru=Ze({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Iu=Ze({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Au=Ze({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Cu=Object.freeze({__proto__:null,base32:mu,base32upper:Du,base32pad:Su,base32padupper:Ou,base32hex:Tu,base32hexupper:xu,base32hexpad:Ru,base32hexpadupper:Iu,base32z:Au});const Lu=cr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Nu=cr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Pu=Object.freeze({__proto__:null,base36:Lu,base36upper:Nu});const Uu=cr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Mu=cr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ju=Object.freeze({__proto__:null,base58btc:Uu,base58flickr:Mu});const Bu=Ze({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fu=Ze({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zu=Ze({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Hu=Ze({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $u=Object.freeze({__proto__:null,base64:Bu,base64pad:Fu,base64url:zu,base64urlpad:Hu});const jn=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ku=jn.reduce((t,e,r)=>(t[r]=e,t),[]),Gu=jn.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Vu(t){return t.reduce((e,r)=>(e+=Ku[r],e),"")}function Yu(t){const e=[];for(const r of t){const i=Gu[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Wu=Cr({prefix:"\u{1F680}",name:"base256emoji",encode:Vu,decode:Yu});var qu=Object.freeze({__proto__:null,base256emoji:Wu}),Xu=Fn,Bn=128,Ju=127,ku=~Ju,Zu=Math.pow(2,31);function Fn(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Zu;)e[r++]=t&255|Bn,t/=128;for(;t&ku;)e[r++]=t&255|Bn,t>>>=7;return e[r]=t|0,Fn.bytes=r-i+1,e}var Qu=bi,ef=128,zn=127;function bi(t,i){var r=0,i=i||0,n=0,o=i,u,c=t.length;do{if(o>=c)throw bi.bytes=0,new RangeError("Could not decode varint");u=t[o++],r+=n<28?(u&zn)<<n:(u&zn)*Math.pow(2,n),n+=7}while(u>=ef);return bi.bytes=o-i,r}var tf=Math.pow(2,7),rf=Math.pow(2,14),nf=Math.pow(2,21),sf=Math.pow(2,28),af=Math.pow(2,35),of=Math.pow(2,42),cf=Math.pow(2,49),uf=Math.pow(2,56),ff=Math.pow(2,63),hf=function(t){return t<tf?1:t<rf?2:t<nf?3:t<sf?4:t<af?5:t<of?6:t<cf?7:t<uf?8:t<ff?9:10},lf={encode:Xu,decode:Qu,encodingLength:hf},Hn=lf;const $n=(t,e,r=0)=>(Hn.encode(t,e,r),e),Kn=t=>Hn.encodingLength(t),Ei=(t,e)=>{const r=e.byteLength,i=Kn(t),n=i+Kn(r),o=new Uint8Array(n+r);return $n(t,o,0),$n(r,o,i),o.set(e,n),new df(t,r,e,o)};class df{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Gn=({name:t,code:e,encode:r})=>new gf(t,e,r);class gf{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Ei(this.code,r):r.then(i=>Ei(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Vn=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),_f=Gn({name:"sha2-256",code:18,encode:Vn("SHA-256")}),pf=Gn({name:"sha2-512",code:19,encode:Vn("SHA-512")});var vf=Object.freeze({__proto__:null,sha256:_f,sha512:pf});const Yn=0,yf="identity",Wn=Un;var bf=Object.freeze({__proto__:null,identity:{code:Yn,name:yf,encode:Wn,digest:t=>Ei(Yn,Wn(t))}});new TextEncoder,new TextDecoder;const qn={...lu,...gu,...pu,...yu,...wu,...Cu,...Pu,...ju,...$u,...qu};({...vf,...bf});function Xn(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Jn=Xn("utf8","u",t=>{const e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),wi=Xn("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Pn(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),kn={utf8:Jn,"utf-8":Jn,hex:qn.base16,latin1:wi,ascii:wi,binary:wi,...qn};function st(t,e="utf8"){const r=kn[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function nt(t,e="utf8"){const r=kn[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Lr(t){return st(nt(ui(t),Yc),Ln)}function Zn(t){const e=nt(Zc,Nn),r=kc+st(yi([e,t]),Nn);return[Xc,Jc,r].join(qc)}function Ef(t){return st(t,Ln)}function wf(t){return nt([Lr(t.header),Lr(t.payload)].join(Cn),Wc)}function mf(t){return[Lr(t.header),Lr(t.payload),Ef(t.signature)].join(Cn)}function Qn(t=or.randomBytes(Qc)){return fi.generateKeyPairFromSeed(t)}async function Df(t,e,r,i,n=Se.fromMiliseconds(Date.now())){const o={alg:Gc,typ:Vc},u=Zn(i.publicKey),c=n+r,f={iss:u,sub:t,aud:e,iat:n,exp:c},d=wf({header:o,payload:f}),g=fi.sign(i.secretKey,d);return mf({header:o,payload:f,signature:g})}var mi={},Nr={};Object.defineProperty(Nr,"__esModule",{value:!0});var et=ee,Di=it,Sf=20;function Of(t,e,r){for(var i=1634760805,n=857760878,o=2036477234,u=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],d=r[11]<<24|r[10]<<16|r[9]<<8|r[8],g=r[15]<<24|r[14]<<16|r[13]<<8|r[12],D=r[19]<<24|r[18]<<16|r[17]<<8|r[16],A=r[23]<<24|r[22]<<16|r[21]<<8|r[20],m=r[27]<<24|r[26]<<16|r[25]<<8|r[24],R=r[31]<<24|r[30]<<16|r[29]<<8|r[28],j=e[3]<<24|e[2]<<16|e[1]<<8|e[0],C=e[7]<<24|e[6]<<16|e[5]<<8|e[4],$=e[11]<<24|e[10]<<16|e[9]<<8|e[8],w=e[15]<<24|e[14]<<16|e[13]<<8|e[12],x=i,p=n,y=o,v=u,s=c,l=f,U=d,H=g,q=D,J=A,k=m,S=R,I=j,G=C,Y=$,N=w,P=0;P<Sf;P+=2)x=x+s|0,I^=x,I=I>>>32-16|I<<16,q=q+I|0,s^=q,s=s>>>32-12|s<<12,p=p+l|0,G^=p,G=G>>>32-16|G<<16,J=J+G|0,l^=J,l=l>>>32-12|l<<12,y=y+U|0,Y^=y,Y=Y>>>32-16|Y<<16,k=k+Y|0,U^=k,U=U>>>32-12|U<<12,v=v+H|0,N^=v,N=N>>>32-16|N<<16,S=S+N|0,H^=S,H=H>>>32-12|H<<12,y=y+U|0,Y^=y,Y=Y>>>32-8|Y<<8,k=k+Y|0,U^=k,U=U>>>32-7|U<<7,v=v+H|0,N^=v,N=N>>>32-8|N<<8,S=S+N|0,H^=S,H=H>>>32-7|H<<7,p=p+l|0,G^=p,G=G>>>32-8|G<<8,J=J+G|0,l^=J,l=l>>>32-7|l<<7,x=x+s|0,I^=x,I=I>>>32-8|I<<8,q=q+I|0,s^=q,s=s>>>32-7|s<<7,x=x+l|0,N^=x,N=N>>>32-16|N<<16,k=k+N|0,l^=k,l=l>>>32-12|l<<12,p=p+U|0,I^=p,I=I>>>32-16|I<<16,S=S+I|0,U^=S,U=U>>>32-12|U<<12,y=y+H|0,G^=y,G=G>>>32-16|G<<16,q=q+G|0,H^=q,H=H>>>32-12|H<<12,v=v+s|0,Y^=v,Y=Y>>>32-16|Y<<16,J=J+Y|0,s^=J,s=s>>>32-12|s<<12,y=y+H|0,G^=y,G=G>>>32-8|G<<8,q=q+G|0,H^=q,H=H>>>32-7|H<<7,v=v+s|0,Y^=v,Y=Y>>>32-8|Y<<8,J=J+Y|0,s^=J,s=s>>>32-7|s<<7,p=p+U|0,I^=p,I=I>>>32-8|I<<8,S=S+I|0,U^=S,U=U>>>32-7|U<<7,x=x+l|0,N^=x,N=N>>>32-8|N<<8,k=k+N|0,l^=k,l=l>>>32-7|l<<7;et.writeUint32LE(x+i|0,t,0),et.writeUint32LE(p+n|0,t,4),et.writeUint32LE(y+o|0,t,8),et.writeUint32LE(v+u|0,t,12),et.writeUint32LE(s+c|0,t,16),et.writeUint32LE(l+f|0,t,20),et.writeUint32LE(U+d|0,t,24),et.writeUint32LE(H+g|0,t,28),et.writeUint32LE(q+D|0,t,32),et.writeUint32LE(J+A|0,t,36),et.writeUint32LE(k+m|0,t,40),et.writeUint32LE(S+R|0,t,44),et.writeUint32LE(I+j|0,t,48),et.writeUint32LE(G+C|0,t,52),et.writeUint32LE(Y+$|0,t,56),et.writeUint32LE(N+w|0,t,60)}function es(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var o,u;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");o=new Uint8Array(16),u=o.length-e.length,o.set(e,u)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");o=e,u=n}for(var c=new Uint8Array(64),f=0;f<r.length;f+=64){Of(c,o,t);for(var d=f;d<f+64&&d<r.length;d++)i[d]=r[d]^c[d-f];xf(o,0,u)}return Di.wipe(c),n===0&&Di.wipe(o),i}Nr.streamXOR=es;function Tf(t,e,r,i){return i===void 0&&(i=0),Di.wipe(r),es(t,e,r,r,i)}Nr.stream=Tf;function xf(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var ts={},St={};Object.defineProperty(St,"__esModule",{value:!0});function Rf(t,e,r){return~(t-1)&e|t-1&r}St.select=Rf;function If(t,e){return(t|0)-(e|0)-1>>>31&1}St.lessOrEqual=If;function rs(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}St.compare=rs;function Af(t,e){return t.length===0||e.length===0?!1:rs(t,e)!==0}St.equal=Af,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=St,r=it;t.DIGEST_LENGTH=16;var i=function(){function u(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=c[0]|c[1]<<8;this._r[0]=f&8191;var d=c[2]|c[3]<<8;this._r[1]=(f>>>13|d<<3)&8191;var g=c[4]|c[5]<<8;this._r[2]=(d>>>10|g<<6)&7939;var D=c[6]|c[7]<<8;this._r[3]=(g>>>7|D<<9)&8191;var A=c[8]|c[9]<<8;this._r[4]=(D>>>4|A<<12)&255,this._r[5]=A>>>1&8190;var m=c[10]|c[11]<<8;this._r[6]=(A>>>14|m<<2)&8191;var R=c[12]|c[13]<<8;this._r[7]=(m>>>11|R<<5)&8065;var j=c[14]|c[15]<<8;this._r[8]=(R>>>8|j<<8)&8191,this._r[9]=j>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return u.prototype._blocks=function(c,f,d){for(var g=this._fin?0:2048,D=this._h[0],A=this._h[1],m=this._h[2],R=this._h[3],j=this._h[4],C=this._h[5],$=this._h[6],w=this._h[7],x=this._h[8],p=this._h[9],y=this._r[0],v=this._r[1],s=this._r[2],l=this._r[3],U=this._r[4],H=this._r[5],q=this._r[6],J=this._r[7],k=this._r[8],S=this._r[9];d>=16;){var I=c[f+0]|c[f+1]<<8;D+=I&8191;var G=c[f+2]|c[f+3]<<8;A+=(I>>>13|G<<3)&8191;var Y=c[f+4]|c[f+5]<<8;m+=(G>>>10|Y<<6)&8191;var N=c[f+6]|c[f+7]<<8;R+=(Y>>>7|N<<9)&8191;var P=c[f+8]|c[f+9]<<8;j+=(N>>>4|P<<12)&8191,C+=P>>>1&8191;var M=c[f+10]|c[f+11]<<8;$+=(P>>>14|M<<2)&8191;var B=c[f+12]|c[f+13]<<8;w+=(M>>>11|B<<5)&8191;var ie=c[f+14]|c[f+15]<<8;x+=(B>>>8|ie<<8)&8191,p+=ie>>>5|g;var F=0,Q=F;Q+=D*y,Q+=A*(5*S),Q+=m*(5*k),Q+=R*(5*J),Q+=j*(5*q),F=Q>>>13,Q&=8191,Q+=C*(5*H),Q+=$*(5*U),Q+=w*(5*l),Q+=x*(5*s),Q+=p*(5*v),F+=Q>>>13,Q&=8191;var W=F;W+=D*v,W+=A*y,W+=m*(5*S),W+=R*(5*k),W+=j*(5*J),F=W>>>13,W&=8191,W+=C*(5*q),W+=$*(5*H),W+=w*(5*U),W+=x*(5*l),W+=p*(5*s),F+=W>>>13,W&=8191;var oe=F;oe+=D*s,oe+=A*v,oe+=m*y,oe+=R*(5*S),oe+=j*(5*k),F=oe>>>13,oe&=8191,oe+=C*(5*J),oe+=$*(5*q),oe+=w*(5*H),oe+=x*(5*U),oe+=p*(5*l),F+=oe>>>13,oe&=8191;var T=F;T+=D*l,T+=A*s,T+=m*v,T+=R*y,T+=j*(5*S),F=T>>>13,T&=8191,T+=C*(5*k),T+=$*(5*J),T+=w*(5*q),T+=x*(5*H),T+=p*(5*U),F+=T>>>13,T&=8191;var O=F;O+=D*U,O+=A*l,O+=m*s,O+=R*v,O+=j*y,F=O>>>13,O&=8191,O+=C*(5*S),O+=$*(5*k),O+=w*(5*J),O+=x*(5*q),O+=p*(5*H),F+=O>>>13,O&=8191;var b=F;b+=D*H,b+=A*U,b+=m*l,b+=R*s,b+=j*v,F=b>>>13,b&=8191,b+=C*y,b+=$*(5*S),b+=w*(5*k),b+=x*(5*J),b+=p*(5*q),F+=b>>>13,b&=8191;var a=F;a+=D*q,a+=A*H,a+=m*U,a+=R*l,a+=j*s,F=a>>>13,a&=8191,a+=C*v,a+=$*y,a+=w*(5*S),a+=x*(5*k),a+=p*(5*J),F+=a>>>13,a&=8191;var _=F;_+=D*J,_+=A*q,_+=m*H,_+=R*U,_+=j*l,F=_>>>13,_&=8191,_+=C*s,_+=$*v,_+=w*y,_+=x*(5*S),_+=p*(5*k),F+=_>>>13,_&=8191;var z=F;z+=D*k,z+=A*J,z+=m*q,z+=R*H,z+=j*U,F=z>>>13,z&=8191,z+=C*l,z+=$*s,z+=w*v,z+=x*y,z+=p*(5*S),F+=z>>>13,z&=8191;var K=F;K+=D*S,K+=A*k,K+=m*J,K+=R*q,K+=j*H,F=K>>>13,K&=8191,K+=C*U,K+=$*l,K+=w*s,K+=x*v,K+=p*y,F+=K>>>13,K&=8191,F=(F<<2)+F|0,F=F+Q|0,Q=F&8191,F=F>>>13,W+=F,D=Q,A=W,m=oe,R=T,j=O,C=b,$=a,w=_,x=z,p=K,f+=16,d-=16}this._h[0]=D,this._h[1]=A,this._h[2]=m,this._h[3]=R,this._h[4]=j,this._h[5]=C,this._h[6]=$,this._h[7]=w,this._h[8]=x,this._h[9]=p},u.prototype.finish=function(c,f){f===void 0&&(f=0);var d=new Uint16Array(10),g,D,A,m;if(this._leftover){for(m=this._leftover,this._buffer[m++]=1;m<16;m++)this._buffer[m]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(g=this._h[1]>>>13,this._h[1]&=8191,m=2;m<10;m++)this._h[m]+=g,g=this._h[m]>>>13,this._h[m]&=8191;for(this._h[0]+=g*5,g=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=g,g=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=g,d[0]=this._h[0]+5,g=d[0]>>>13,d[0]&=8191,m=1;m<10;m++)d[m]=this._h[m]+g,g=d[m]>>>13,d[m]&=8191;for(d[9]-=1<<13,D=(g^1)-1,m=0;m<10;m++)d[m]&=D;for(D=~D,m=0;m<10;m++)this._h[m]=this._h[m]&D|d[m];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,A=this._h[0]+this._pad[0],this._h[0]=A&65535,m=1;m<8;m++)A=(this._h[m]+this._pad[m]|0)+(A>>>16)|0,this._h[m]=A&65535;return c[f+0]=this._h[0]>>>0,c[f+1]=this._h[0]>>>8,c[f+2]=this._h[1]>>>0,c[f+3]=this._h[1]>>>8,c[f+4]=this._h[2]>>>0,c[f+5]=this._h[2]>>>8,c[f+6]=this._h[3]>>>0,c[f+7]=this._h[3]>>>8,c[f+8]=this._h[4]>>>0,c[f+9]=this._h[4]>>>8,c[f+10]=this._h[5]>>>0,c[f+11]=this._h[5]>>>8,c[f+12]=this._h[6]>>>0,c[f+13]=this._h[6]>>>8,c[f+14]=this._h[7]>>>0,c[f+15]=this._h[7]>>>8,this._finished=!0,this},u.prototype.update=function(c){var f=0,d=c.length,g;if(this._leftover){g=16-this._leftover,g>d&&(g=d);for(var D=0;D<g;D++)this._buffer[this._leftover+D]=c[f+D];if(d-=g,f+=g,this._leftover+=g,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(d>=16&&(g=d-d%16,this._blocks(c,f,g),f+=g,d-=g),d){for(var D=0;D<d;D++)this._buffer[this._leftover+D]=c[f+D];this._leftover+=d}return this},u.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},u.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},u}();t.Poly1305=i;function n(u,c){var f=new i(u);f.update(c);var d=f.digest();return f.clean(),d}t.oneTimeAuth=n;function o(u,c){return u.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(u,c)}t.equal=o}(ts),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Nr,r=ts,i=it,n=ee,o=St;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var u=new Uint8Array(16),c=function(){function f(d){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,d.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(d)}return f.prototype.seal=function(d,g,D,A){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var m=new Uint8Array(16);m.set(d,m.length-d.length);var R=new Uint8Array(32);e.stream(this._key,m,R,4);var j=g.length+this.tagLength,C;if(A){if(A.length!==j)throw new Error("ChaCha20Poly1305: incorrect destination length");C=A}else C=new Uint8Array(j);return e.streamXOR(this._key,m,g,C,4),this._authenticate(C.subarray(C.length-this.tagLength,C.length),R,C.subarray(0,C.length-this.tagLength),D),i.wipe(m),C},f.prototype.open=function(d,g,D,A){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(g.length<this.tagLength)return null;var m=new Uint8Array(16);m.set(d,m.length-d.length);var R=new Uint8Array(32);e.stream(this._key,m,R,4);var j=new Uint8Array(this.tagLength);if(this._authenticate(j,R,g.subarray(0,g.length-this.tagLength),D),!o.equal(j,g.subarray(g.length-this.tagLength,g.length)))return null;var C=g.length-this.tagLength,$;if(A){if(A.length!==C)throw new Error("ChaCha20Poly1305: incorrect destination length");$=A}else $=new Uint8Array(C);return e.streamXOR(this._key,m,g.subarray(0,g.length-this.tagLength),$,4),i.wipe(m),$},f.prototype.clean=function(){return i.wipe(this._key),this},f.prototype._authenticate=function(d,g,D,A){var m=new r.Poly1305(g);A&&(m.update(A),A.length%16>0&&m.update(u.subarray(A.length%16))),m.update(D),D.length%16>0&&m.update(u.subarray(D.length%16));var R=new Uint8Array(8);A&&n.writeUint64LE(A.length,R),m.update(R),n.writeUint64LE(D.length,R),m.update(R);for(var j=m.digest(),C=0;C<j.length;C++)d[C]=j[C];m.clean(),i.wipe(j),i.wipe(R)},f}();t.ChaCha20Poly1305=c}(mi);var is={},ur={},Si={};Object.defineProperty(Si,"__esModule",{value:!0});function Cf(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Si.isSerializableHash=Cf,Object.defineProperty(ur,"__esModule",{value:!0});var vt=Si,Lf=St,Nf=it,ns=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),vt.isSerializableHash(this._inner)&&vt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Nf.wipe(i)}return t.prototype.reset=function(){if(!vt.isSerializableHash(this._inner)||!vt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){vt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),vt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!vt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!vt.isSerializableHash(this._inner)||!vt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!vt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();ur.HMAC=ns;function Pf(t,e,r){var i=new ns(t,e);i.update(r);var n=i.digest();return i.clean(),n}ur.hmac=Pf,ur.equal=Lf.equal,Object.defineProperty(is,"__esModule",{value:!0});var ss=ur,as=it,Uf=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var o=ss.hmac(this._hash,i,r);this._hmac=new ss.HMAC(e,o),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),as.wipe(this._buffer),as.wipe(this._counter),this._bufpos=0},t}(),Mf=is.HKDF=Uf,Pr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ee,r=it;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(f,d){if(d===void 0&&(d=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var g=0;if(this._bytesHashed+=d,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&d>0;)this._buffer[this._bufferLength++]=f[g++],d--;this._bufferLength===this.blockSize&&(o(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(d>=this.blockSize&&(g=o(this._temp,this._state,f,g,d),d%=this.blockSize);d>0;)this._buffer[this._bufferLength++]=f[g++],d--;return this},c.prototype.finish=function(f){if(!this._finished){var d=this._bytesHashed,g=this._bufferLength,D=d/536870912|0,A=d<<3,m=d%64<56?64:128;this._buffer[g]=128;for(var R=g+1;R<m-8;R++)this._buffer[R]=0;e.writeUint32BE(D,this._buffer,m-8),e.writeUint32BE(A,this._buffer,m-4),o(this._temp,this._state,this._buffer,0,m),this._finished=!0}for(var R=0;R<this.digestLength/4;R++)e.writeUint32BE(this._state[R],f,R*4);return this},c.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(f){r.wipe(f.state),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},c}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function o(c,f,d,g,D){for(;D>=64;){for(var A=f[0],m=f[1],R=f[2],j=f[3],C=f[4],$=f[5],w=f[6],x=f[7],p=0;p<16;p++){var y=g+p*4;c[p]=e.readUint32BE(d,y)}for(var p=16;p<64;p++){var v=c[p-2],s=(v>>>17|v<<32-17)^(v>>>19|v<<32-19)^v>>>10;v=c[p-15];var l=(v>>>7|v<<32-7)^(v>>>18|v<<32-18)^v>>>3;c[p]=(s+c[p-7]|0)+(l+c[p-16]|0)}for(var p=0;p<64;p++){var s=(((C>>>6|C<<26)^(C>>>11|C<<21)^(C>>>25|C<<7))+(C&$^~C&w)|0)+(x+(n[p]+c[p]|0)|0)|0,l=((A>>>2|A<<32-2)^(A>>>13|A<<32-13)^(A>>>22|A<<32-22))+(A&m^A&R^m&R)|0;x=w,w=$,$=C,C=j+s|0,j=R,R=m,m=A,A=s+l|0}f[0]+=A,f[1]+=m,f[2]+=R,f[3]+=j,f[4]+=C,f[5]+=$,f[6]+=w,f[7]+=x,g+=64,D-=64}return g}function u(c){var f=new i;f.update(c);var d=f.digest();return f.clean(),d}t.hash=u})(Pr);var Oi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=or,r=it;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(p){var y=new Float64Array(16);if(p)for(var v=0;v<p.length;v++)y[v]=p[v];return y}var n=new Uint8Array(32);n[0]=9;var o=i([56129,1]);function u(p){for(var y=1,v=0;v<16;v++){var s=p[v]+y+65535;y=Math.floor(s/65536),p[v]=s-y*65536}p[0]+=y-1+37*(y-1)}function c(p,y,v){for(var s=~(v-1),l=0;l<16;l++){var U=s&(p[l]^y[l]);p[l]^=U,y[l]^=U}}function f(p,y){for(var v=i(),s=i(),l=0;l<16;l++)s[l]=y[l];u(s),u(s),u(s);for(var U=0;U<2;U++){v[0]=s[0]-65517;for(var l=1;l<15;l++)v[l]=s[l]-65535-(v[l-1]>>16&1),v[l-1]&=65535;v[15]=s[15]-32767-(v[14]>>16&1);var H=v[15]>>16&1;v[14]&=65535,c(s,v,1-H)}for(var l=0;l<16;l++)p[2*l]=s[l]&255,p[2*l+1]=s[l]>>8}function d(p,y){for(var v=0;v<16;v++)p[v]=y[2*v]+(y[2*v+1]<<8);p[15]&=32767}function g(p,y,v){for(var s=0;s<16;s++)p[s]=y[s]+v[s]}function D(p,y,v){for(var s=0;s<16;s++)p[s]=y[s]-v[s]}function A(p,y,v){var s,l,U=0,H=0,q=0,J=0,k=0,S=0,I=0,G=0,Y=0,N=0,P=0,M=0,B=0,ie=0,F=0,Q=0,W=0,oe=0,T=0,O=0,b=0,a=0,_=0,z=0,K=0,he=0,ve=0,de=0,Ee=0,Ue=0,Ce=0,pe=v[0],ge=v[1],le=v[2],ue=v[3],ce=v[4],ae=v[5],se=v[6],te=v[7],fe=v[8],_e=v[9],re=v[10],ye=v[11],be=v[12],me=v[13],De=v[14],we=v[15];s=y[0],U+=s*pe,H+=s*ge,q+=s*le,J+=s*ue,k+=s*ce,S+=s*ae,I+=s*se,G+=s*te,Y+=s*fe,N+=s*_e,P+=s*re,M+=s*ye,B+=s*be,ie+=s*me,F+=s*De,Q+=s*we,s=y[1],H+=s*pe,q+=s*ge,J+=s*le,k+=s*ue,S+=s*ce,I+=s*ae,G+=s*se,Y+=s*te,N+=s*fe,P+=s*_e,M+=s*re,B+=s*ye,ie+=s*be,F+=s*me,Q+=s*De,W+=s*we,s=y[2],q+=s*pe,J+=s*ge,k+=s*le,S+=s*ue,I+=s*ce,G+=s*ae,Y+=s*se,N+=s*te,P+=s*fe,M+=s*_e,B+=s*re,ie+=s*ye,F+=s*be,Q+=s*me,W+=s*De,oe+=s*we,s=y[3],J+=s*pe,k+=s*ge,S+=s*le,I+=s*ue,G+=s*ce,Y+=s*ae,N+=s*se,P+=s*te,M+=s*fe,B+=s*_e,ie+=s*re,F+=s*ye,Q+=s*be,W+=s*me,oe+=s*De,T+=s*we,s=y[4],k+=s*pe,S+=s*ge,I+=s*le,G+=s*ue,Y+=s*ce,N+=s*ae,P+=s*se,M+=s*te,B+=s*fe,ie+=s*_e,F+=s*re,Q+=s*ye,W+=s*be,oe+=s*me,T+=s*De,O+=s*we,s=y[5],S+=s*pe,I+=s*ge,G+=s*le,Y+=s*ue,N+=s*ce,P+=s*ae,M+=s*se,B+=s*te,ie+=s*fe,F+=s*_e,Q+=s*re,W+=s*ye,oe+=s*be,T+=s*me,O+=s*De,b+=s*we,s=y[6],I+=s*pe,G+=s*ge,Y+=s*le,N+=s*ue,P+=s*ce,M+=s*ae,B+=s*se,ie+=s*te,F+=s*fe,Q+=s*_e,W+=s*re,oe+=s*ye,T+=s*be,O+=s*me,b+=s*De,a+=s*we,s=y[7],G+=s*pe,Y+=s*ge,N+=s*le,P+=s*ue,M+=s*ce,B+=s*ae,ie+=s*se,F+=s*te,Q+=s*fe,W+=s*_e,oe+=s*re,T+=s*ye,O+=s*be,b+=s*me,a+=s*De,_+=s*we,s=y[8],Y+=s*pe,N+=s*ge,P+=s*le,M+=s*ue,B+=s*ce,ie+=s*ae,F+=s*se,Q+=s*te,W+=s*fe,oe+=s*_e,T+=s*re,O+=s*ye,b+=s*be,a+=s*me,_+=s*De,z+=s*we,s=y[9],N+=s*pe,P+=s*ge,M+=s*le,B+=s*ue,ie+=s*ce,F+=s*ae,Q+=s*se,W+=s*te,oe+=s*fe,T+=s*_e,O+=s*re,b+=s*ye,a+=s*be,_+=s*me,z+=s*De,K+=s*we,s=y[10],P+=s*pe,M+=s*ge,B+=s*le,ie+=s*ue,F+=s*ce,Q+=s*ae,W+=s*se,oe+=s*te,T+=s*fe,O+=s*_e,b+=s*re,a+=s*ye,_+=s*be,z+=s*me,K+=s*De,he+=s*we,s=y[11],M+=s*pe,B+=s*ge,ie+=s*le,F+=s*ue,Q+=s*ce,W+=s*ae,oe+=s*se,T+=s*te,O+=s*fe,b+=s*_e,a+=s*re,_+=s*ye,z+=s*be,K+=s*me,he+=s*De,ve+=s*we,s=y[12],B+=s*pe,ie+=s*ge,F+=s*le,Q+=s*ue,W+=s*ce,oe+=s*ae,T+=s*se,O+=s*te,b+=s*fe,a+=s*_e,_+=s*re,z+=s*ye,K+=s*be,he+=s*me,ve+=s*De,de+=s*we,s=y[13],ie+=s*pe,F+=s*ge,Q+=s*le,W+=s*ue,oe+=s*ce,T+=s*ae,O+=s*se,b+=s*te,a+=s*fe,_+=s*_e,z+=s*re,K+=s*ye,he+=s*be,ve+=s*me,de+=s*De,Ee+=s*we,s=y[14],F+=s*pe,Q+=s*ge,W+=s*le,oe+=s*ue,T+=s*ce,O+=s*ae,b+=s*se,a+=s*te,_+=s*fe,z+=s*_e,K+=s*re,he+=s*ye,ve+=s*be,de+=s*me,Ee+=s*De,Ue+=s*we,s=y[15],Q+=s*pe,W+=s*ge,oe+=s*le,T+=s*ue,O+=s*ce,b+=s*ae,a+=s*se,_+=s*te,z+=s*fe,K+=s*_e,he+=s*re,ve+=s*ye,de+=s*be,Ee+=s*me,Ue+=s*De,Ce+=s*we,U+=38*W,H+=38*oe,q+=38*T,J+=38*O,k+=38*b,S+=38*a,I+=38*_,G+=38*z,Y+=38*K,N+=38*he,P+=38*ve,M+=38*de,B+=38*Ee,ie+=38*Ue,F+=38*Ce,l=1,s=U+l+65535,l=Math.floor(s/65536),U=s-l*65536,s=H+l+65535,l=Math.floor(s/65536),H=s-l*65536,s=q+l+65535,l=Math.floor(s/65536),q=s-l*65536,s=J+l+65535,l=Math.floor(s/65536),J=s-l*65536,s=k+l+65535,l=Math.floor(s/65536),k=s-l*65536,s=S+l+65535,l=Math.floor(s/65536),S=s-l*65536,s=I+l+65535,l=Math.floor(s/65536),I=s-l*65536,s=G+l+65535,l=Math.floor(s/65536),G=s-l*65536,s=Y+l+65535,l=Math.floor(s/65536),Y=s-l*65536,s=N+l+65535,l=Math.floor(s/65536),N=s-l*65536,s=P+l+65535,l=Math.floor(s/65536),P=s-l*65536,s=M+l+65535,l=Math.floor(s/65536),M=s-l*65536,s=B+l+65535,l=Math.floor(s/65536),B=s-l*65536,s=ie+l+65535,l=Math.floor(s/65536),ie=s-l*65536,s=F+l+65535,l=Math.floor(s/65536),F=s-l*65536,s=Q+l+65535,l=Math.floor(s/65536),Q=s-l*65536,U+=l-1+37*(l-1),l=1,s=U+l+65535,l=Math.floor(s/65536),U=s-l*65536,s=H+l+65535,l=Math.floor(s/65536),H=s-l*65536,s=q+l+65535,l=Math.floor(s/65536),q=s-l*65536,s=J+l+65535,l=Math.floor(s/65536),J=s-l*65536,s=k+l+65535,l=Math.floor(s/65536),k=s-l*65536,s=S+l+65535,l=Math.floor(s/65536),S=s-l*65536,s=I+l+65535,l=Math.floor(s/65536),I=s-l*65536,s=G+l+65535,l=Math.floor(s/65536),G=s-l*65536,s=Y+l+65535,l=Math.floor(s/65536),Y=s-l*65536,s=N+l+65535,l=Math.floor(s/65536),N=s-l*65536,s=P+l+65535,l=Math.floor(s/65536),P=s-l*65536,s=M+l+65535,l=Math.floor(s/65536),M=s-l*65536,s=B+l+65535,l=Math.floor(s/65536),B=s-l*65536,s=ie+l+65535,l=Math.floor(s/65536),ie=s-l*65536,s=F+l+65535,l=Math.floor(s/65536),F=s-l*65536,s=Q+l+65535,l=Math.floor(s/65536),Q=s-l*65536,U+=l-1+37*(l-1),p[0]=U,p[1]=H,p[2]=q,p[3]=J,p[4]=k,p[5]=S,p[6]=I,p[7]=G,p[8]=Y,p[9]=N,p[10]=P,p[11]=M,p[12]=B,p[13]=ie,p[14]=F,p[15]=Q}function m(p,y){A(p,y,y)}function R(p,y){for(var v=i(),s=0;s<16;s++)v[s]=y[s];for(var s=253;s>=0;s--)m(v,v),s!==2&&s!==4&&A(v,v,y);for(var s=0;s<16;s++)p[s]=v[s]}function j(p,y){for(var v=new Uint8Array(32),s=new Float64Array(80),l=i(),U=i(),H=i(),q=i(),J=i(),k=i(),S=0;S<31;S++)v[S]=p[S];v[31]=p[31]&127|64,v[0]&=248,d(s,y);for(var S=0;S<16;S++)U[S]=s[S];l[0]=q[0]=1;for(var S=254;S>=0;--S){var I=v[S>>>3]>>>(S&7)&1;c(l,U,I),c(H,q,I),g(J,l,H),D(l,l,H),g(H,U,q),D(U,U,q),m(q,J),m(k,l),A(l,H,l),A(H,U,J),g(J,l,H),D(l,l,H),m(U,l),D(H,q,k),A(l,H,o),g(l,l,q),A(H,H,l),A(l,q,k),A(q,U,s),m(U,J),c(l,U,I),c(H,q,I)}for(var S=0;S<16;S++)s[S+16]=l[S],s[S+32]=H[S],s[S+48]=U[S],s[S+64]=q[S];var G=s.subarray(32),Y=s.subarray(16);R(G,G),A(Y,Y,G);var N=new Uint8Array(32);return f(N,Y),N}t.scalarMult=j;function C(p){return j(p,n)}t.scalarMultBase=C;function $(p){if(p.length!==t.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+t.SECRET_KEY_LENGTH+" bytes");var y=new Uint8Array(p),v=C(y);return{publicKey:v,secretKey:y}}t.generateKeyPairFromSeed=$;function w(p){var y=e.randomBytes(32,p),v=$(y);return r.wipe(y),v}t.generateKeyPair=w;function x(p,y,v){if(v===void 0&&(v=!1),p.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(y.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var s=j(p,y);if(v){for(var l=0,U=0;U<s.length;U++)l|=s[U];if(l===0)throw new Error("X25519: invalid shared key")}return s}t.sharedKey=x})(Oi);var os=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,o;i<n;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},jf=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),Bf=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Ff=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),zf=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Hf=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),$f=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Kf=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,cs=3,Gf=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",$f]],us=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Vf(t){return t?fs(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Hf:typeof navigator<"u"?fs(navigator.userAgent):qf()}function Yf(t){return t!==""&&Gf.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var o=n.exec(t);return!!o&&[i,o]},!1)}function fs(t){var e=Yf(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new zf;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<cs&&(n=os(os([],n,!0),Xf(cs-n.length),!0)):n=[];var o=n.join("."),u=Wf(t),c=Kf.exec(t);return c&&c[1]?new Ff(r,o,u,c[1]):new jf(r,o,u)}function Wf(t){for(var e=0,r=us.length;e<r;e++){var i=us[e],n=i[0],o=i[1],u=o.exec(t);if(u)return n}return null}function qf(){var t=typeof process<"u"&&process.version;return t?new Bf(process.version.slice(1)):null}function Xf(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=ls=Oe.getLocation=Oe.getLocationOrThrow=Ti=Oe.getNavigator=Oe.getNavigatorOrThrow=hs=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Pt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Oe.getFromWindow=Pt;function Yt(t){const e=Pt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Oe.getFromWindowOrThrow=Yt;function Jf(){return Yt("document")}Oe.getDocumentOrThrow=Jf;function kf(){return Pt("document")}var hs=Oe.getDocument=kf;function Zf(){return Yt("navigator")}Oe.getNavigatorOrThrow=Zf;function Qf(){return Pt("navigator")}var Ti=Oe.getNavigator=Qf;function eh(){return Yt("location")}Oe.getLocationOrThrow=eh;function th(){return Pt("location")}var ls=Oe.getLocation=th;function rh(){return Yt("crypto")}Oe.getCryptoOrThrow=rh;function ih(){return Pt("crypto")}Oe.getCrypto=ih;function nh(){return Yt("localStorage")}Oe.getLocalStorageOrThrow=nh;function sh(){return Pt("localStorage")}Oe.getLocalStorage=sh;var xi={};Object.defineProperty(xi,"__esModule",{value:!0}),xi.getWindowMetadata=void 0;const ds=Oe;function ah(){let t,e;try{t=ds.getDocumentOrThrow(),e=ds.getLocationOrThrow()}catch{return null}function r(){const D=t.getElementsByTagName("link"),A=[];for(let m=0;m<D.length;m++){const R=D[m],j=R.getAttribute("rel");if(j&&j.toLowerCase().indexOf("icon")>-1){const C=R.getAttribute("href");if(C)if(C.toLowerCase().indexOf("https:")===-1&&C.toLowerCase().indexOf("http:")===-1&&C.indexOf("//")!==0){let $=e.protocol+"//"+e.host;if(C.indexOf("/")===0)$+=C;else{const w=e.pathname.split("/");w.pop(),$+=w.join("/")+"/"+C}A.push($)}else if(C.indexOf("//")===0){const $=e.protocol+C;A.push($)}else A.push(C)}}return A}function i(...D){const A=t.getElementsByTagName("meta");for(let m=0;m<A.length;m++){const R=A[m],j=["itemprop","property","name"].map(C=>R.getAttribute(C)).filter(C=>C?D.includes(C):!1);if(j.length&&j){const C=R.getAttribute("content");if(C)return C}}return""}function n(){let D=i("name","og:site_name","og:title","twitter:title");return D||(D=t.title),D}function o(){return i("description","og:description","twitter:description","keywords")}const u=n(),c=o(),f=e.origin,d=r();return{description:c,url:f,icons:d,name:u}}xi.getWindowMetadata=ah;var fr={},oh=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),gs="%[a-f0-9]{2}",_s=new RegExp(gs,"gi"),ps=new RegExp("("+gs+")+","gi");function Ri(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],Ri(r),Ri(i))}function ch(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(_s),r=1;r<e.length;r++)t=Ri(e,r).join(""),e=t.match(_s);return t}}function uh(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=ps.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=ch(r[0]);i!==r[0]&&(e[r[0]]=i)}r=ps.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),o=0;o<n.length;o++){var u=n[o];t=t.replace(new RegExp(u,"g"),e[u])}return t}var fh=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return uh(t)}},hh=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},lh=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),o=0;o<i.length;o++){var u=i[o],c=t[u];(n?e.indexOf(u)!==-1:e(u,c,t))&&(r[u]=c)}return r};(function(t){const e=oh,r=fh,i=hh,n=lh,o=w=>w==null,u=Symbol("encodeFragmentIdentifier");function c(w){switch(w.arrayFormat){case"index":return x=>(p,y)=>{const v=p.length;return y===void 0||w.skipNull&&y===null||w.skipEmptyString&&y===""?p:y===null?[...p,[g(x,w),"[",v,"]"].join("")]:[...p,[g(x,w),"[",g(v,w),"]=",g(y,w)].join("")]};case"bracket":return x=>(p,y)=>y===void 0||w.skipNull&&y===null||w.skipEmptyString&&y===""?p:y===null?[...p,[g(x,w),"[]"].join("")]:[...p,[g(x,w),"[]=",g(y,w)].join("")];case"colon-list-separator":return x=>(p,y)=>y===void 0||w.skipNull&&y===null||w.skipEmptyString&&y===""?p:y===null?[...p,[g(x,w),":list="].join("")]:[...p,[g(x,w),":list=",g(y,w)].join("")];case"comma":case"separator":case"bracket-separator":{const x=w.arrayFormat==="bracket-separator"?"[]=":"=";return p=>(y,v)=>v===void 0||w.skipNull&&v===null||w.skipEmptyString&&v===""?y:(v=v===null?"":v,y.length===0?[[g(p,w),x,g(v,w)].join("")]:[[y,g(v,w)].join(w.arrayFormatSeparator)])}default:return x=>(p,y)=>y===void 0||w.skipNull&&y===null||w.skipEmptyString&&y===""?p:y===null?[...p,g(x,w)]:[...p,[g(x,w),"=",g(y,w)].join("")]}}function f(w){let x;switch(w.arrayFormat){case"index":return(p,y,v)=>{if(x=/\[(\d*)\]$/.exec(p),p=p.replace(/\[\d*\]$/,""),!x){v[p]=y;return}v[p]===void 0&&(v[p]={}),v[p][x[1]]=y};case"bracket":return(p,y,v)=>{if(x=/(\[\])$/.exec(p),p=p.replace(/\[\]$/,""),!x){v[p]=y;return}if(v[p]===void 0){v[p]=[y];return}v[p]=[].concat(v[p],y)};case"colon-list-separator":return(p,y,v)=>{if(x=/(:list)$/.exec(p),p=p.replace(/:list$/,""),!x){v[p]=y;return}if(v[p]===void 0){v[p]=[y];return}v[p]=[].concat(v[p],y)};case"comma":case"separator":return(p,y,v)=>{const s=typeof y=="string"&&y.includes(w.arrayFormatSeparator),l=typeof y=="string"&&!s&&D(y,w).includes(w.arrayFormatSeparator);y=l?D(y,w):y;const U=s||l?y.split(w.arrayFormatSeparator).map(H=>D(H,w)):y===null?y:D(y,w);v[p]=U};case"bracket-separator":return(p,y,v)=>{const s=/(\[\])$/.test(p);if(p=p.replace(/\[\]$/,""),!s){v[p]=y&&D(y,w);return}const l=y===null?[]:y.split(w.arrayFormatSeparator).map(U=>D(U,w));if(v[p]===void 0){v[p]=l;return}v[p]=[].concat(v[p],l)};default:return(p,y,v)=>{if(v[p]===void 0){v[p]=y;return}v[p]=[].concat(v[p],y)}}}function d(w){if(typeof w!="string"||w.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function g(w,x){return x.encode?x.strict?e(w):encodeURIComponent(w):w}function D(w,x){return x.decode?r(w):w}function A(w){return Array.isArray(w)?w.sort():typeof w=="object"?A(Object.keys(w)).sort((x,p)=>Number(x)-Number(p)).map(x=>w[x]):w}function m(w){const x=w.indexOf("#");return x!==-1&&(w=w.slice(0,x)),w}function R(w){let x="";const p=w.indexOf("#");return p!==-1&&(x=w.slice(p)),x}function j(w){w=m(w);const x=w.indexOf("?");return x===-1?"":w.slice(x+1)}function C(w,x){return x.parseNumbers&&!Number.isNaN(Number(w))&&typeof w=="string"&&w.trim()!==""?w=Number(w):x.parseBooleans&&w!==null&&(w.toLowerCase()==="true"||w.toLowerCase()==="false")&&(w=w.toLowerCase()==="true"),w}function $(w,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),d(x.arrayFormatSeparator);const p=f(x),y=Object.create(null);if(typeof w!="string"||(w=w.trim().replace(/^[?#&]/,""),!w))return y;for(const v of w.split("&")){if(v==="")continue;let[s,l]=i(x.decode?v.replace(/\+/g," "):v,"=");l=l===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?l:D(l,x),p(D(s,x),l,y)}for(const v of Object.keys(y)){const s=y[v];if(typeof s=="object"&&s!==null)for(const l of Object.keys(s))s[l]=C(s[l],x);else y[v]=C(s,x)}return x.sort===!1?y:(x.sort===!0?Object.keys(y).sort():Object.keys(y).sort(x.sort)).reduce((v,s)=>{const l=y[s];return Boolean(l)&&typeof l=="object"&&!Array.isArray(l)?v[s]=A(l):v[s]=l,v},Object.create(null))}t.extract=j,t.parse=$,t.stringify=(w,x)=>{if(!w)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),d(x.arrayFormatSeparator);const p=l=>x.skipNull&&o(w[l])||x.skipEmptyString&&w[l]==="",y=c(x),v={};for(const l of Object.keys(w))p(l)||(v[l]=w[l]);const s=Object.keys(v);return x.sort!==!1&&s.sort(x.sort),s.map(l=>{const U=w[l];return U===void 0?"":U===null?g(l,x):Array.isArray(U)?U.length===0&&x.arrayFormat==="bracket-separator"?g(l,x)+"[]":U.reduce(y(l),[]).join("&"):g(l,x)+"="+g(U,x)}).filter(l=>l.length>0).join("&")},t.parseUrl=(w,x)=>{x=Object.assign({decode:!0},x);const[p,y]=i(w,"#");return Object.assign({url:p.split("?")[0]||"",query:$(j(w),x)},x&&x.parseFragmentIdentifier&&y?{fragmentIdentifier:D(y,x)}:{})},t.stringifyUrl=(w,x)=>{x=Object.assign({encode:!0,strict:!0,[u]:!0},x);const p=m(w.url).split("?")[0]||"",y=t.extract(w.url),v=t.parse(y,{sort:!1}),s=Object.assign(v,w.query);let l=t.stringify(s,x);l&&(l=`?${l}`);let U=R(w.url);return w.fragmentIdentifier&&(U=`#${x[u]?g(w.fragmentIdentifier,x):w.fragmentIdentifier}`),`${p}${l}${U}`},t.pick=(w,x,p)=>{p=Object.assign({parseFragmentIdentifier:!0,[u]:!1},p);const{url:y,query:v,fragmentIdentifier:s}=t.parseUrl(w,p);return t.stringifyUrl({url:y,query:n(v,x),fragmentIdentifier:s},p)},t.exclude=(w,x,p)=>{const y=Array.isArray(x)?v=>!x.includes(v):(v,s)=>!x(v,s);return t.pick(w,y,p)}})(fr);const dh={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},vs="base10",at="base16",Ii="base64pad",Ai="utf8",ys=0,Wt=1,gh=0,bs=1,Ci=12,Li=32;function _h(){const t=Oi.generateKeyPair();return{privateKey:st(t.secretKey,at),publicKey:st(t.publicKey,at)}}function Ni(){const t=or.randomBytes(Li);return st(t,at)}function ph(t,e){const r=Oi.sharedKey(nt(t,at),nt(e,at)),i=new Mf(Pr.SHA256,r).expand(Li);return st(i,at)}function vh(t){const e=Pr.hash(nt(t,at));return st(e,at)}function Ur(t){const e=Pr.hash(nt(t,Ai));return st(e,at)}function yh(t){return nt(`${t}`,vs)}function hr(t){return Number(st(t,vs))}function bh(t){const e=yh(typeof t.type<"u"?t.type:ys);if(hr(e)===Wt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?nt(t.senderPublicKey,at):void 0,i=typeof t.iv<"u"?nt(t.iv,at):or.randomBytes(Ci),n=new mi.ChaCha20Poly1305(nt(t.symKey,at)).seal(i,nt(t.message,Ai));return wh({type:e,sealed:n,iv:i,senderPublicKey:r})}function Eh(t){const e=new mi.ChaCha20Poly1305(nt(t.symKey,at)),{sealed:r,iv:i}=Pi(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return st(n,Ai)}function wh(t){if(hr(t.type)===Wt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return st(yi([t.type,t.senderPublicKey,t.iv,t.sealed]),Ii)}return st(yi([t.type,t.iv,t.sealed]),Ii)}function Pi(t){const e=nt(t,Ii),r=e.slice(gh,bs),i=bs;if(hr(r)===Wt){const c=i+Li,f=c+Ci,d=e.slice(i,c),g=e.slice(c,f),D=e.slice(f);return{type:r,sealed:D,iv:g,senderPublicKey:d}}const n=i+Ci,o=e.slice(i,n),u=e.slice(n);return{type:r,sealed:u,iv:o}}function mh(t,e){const r=Pi(t);return Es({type:hr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?st(r.senderPublicKey,at):void 0,receiverPublicKey:e?.receiverPublicKey})}function Es(t){const e=t?.type||ys;if(e===Wt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function ws(t){return t.type===Wt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Dh=Object.defineProperty,ms=Object.getOwnPropertySymbols,Sh=Object.prototype.hasOwnProperty,Oh=Object.prototype.propertyIsEnumerable,Ds=(t,e,r)=>e in t?Dh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ss=(t,e)=>{for(var r in e||(e={}))Sh.call(e,r)&&Ds(t,r,e[r]);if(ms)for(var r of ms(e))Oh.call(e,r)&&Ds(t,r,e[r]);return t};const Th="ReactNative",lr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},xh="js";function Os(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Rh(){return!hs()&&!!Ti()&&navigator.product===Th}function Ih(){return!Os()&&!!Ti()}function Ah(){return Rh()?lr.reactNative:Os()?lr.node:Ih()?lr.browser:lr.unknown}function Ch(t,e){let r=fr.parse(t);return r=Ss(Ss({},r),e),t=fr.stringify(r),t}function Lh(){const t=Vf();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Nh(){var t;const e=Ah();return e===lr.browser?[e,((t=ls())==null?void 0:t.host)||"unknown"].join(":"):e}function Ph(t,e,r){const i=Lh(),n=Nh();return[[t,e].join("-"),[xh,r].join("-"),i,n].join("/")}function Uh({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:o}){const u=r.split("?"),c=Ph(t,e,i),f={auth:n,ua:c,projectId:o},d=Ch(u[1]||"",f);return u[0]+"?"+d}function Ts(t){return Object.fromEntries(t.entries())}function xs(t){return new Map(Object.entries(t))}function Ui(t,e){return Se.fromMiliseconds((e||Date.now())+Se.toMiliseconds(t))}function Rs(t){return Se.fromMiliseconds(Date.now())>=Se.toMiliseconds(t)}function Mh(){const t=Se.toMiliseconds(Se.FIVE_MINUTES);let e,r,i;return{resolve:n=>{i&&e&&(clearTimeout(i),e(n))},reject:n=>{i&&r&&(clearTimeout(i),r(n))},done:()=>new Promise((n,o)=>{i=setTimeout(o,t),e=n,r=o})}}function Is(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function jh(t){return Is("topic",t)}function Bh(t){return Is("id",t)}function Fh(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Mi(t,e){return`${t}${e?`:${e}`:""}`}const zh="irn";function ji(t){return t?.relay||{protocol:zh}}function Bi(t){const e=dh[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Hh=Object.defineProperty,As=Object.getOwnPropertySymbols,$h=Object.prototype.hasOwnProperty,Kh=Object.prototype.propertyIsEnumerable,Cs=(t,e,r)=>e in t?Hh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Gh=(t,e)=>{for(var r in e||(e={}))$h.call(e,r)&&Cs(t,r,e[r]);if(As)for(var r of As(e))Kh.call(e,r)&&Cs(t,r,e[r]);return t};function Vh(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const o=n.replace(i,""),u=t[n];r[o]=u}}),r}function Yh(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),o=typeof r<"u"?t.substring(r):"",u=fr.parse(o);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:u.symKey,relay:Vh(u)}}function Wh(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const o=r+e+n;t[n]&&(i[o]=t[n])}),i}function qh(t){return`${t.protocol}:${t.topic}@${t.version}?`+fr.stringify(Gh({symKey:t.symKey},Wh(t.relay)))}const Xh={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Jh={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Te(t,e){const{message:r,code:i}=Jh[t];return{message:e?`${r} ${e}`:r,code:i}}function dr(t,e){const{message:r,code:i}=Xh[t];return{message:e?`${r} ${e}`:r,code:i}}function Mr(t){return typeof t>"u"}function Ls(t,e){return e&&Mr(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function kh(t){if(Ls(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Zh(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Qh(t){return t?.topic}function Fi(t){return typeof t<"u"&&typeof t!==null}const zi="wc",Ns=2,jr="core",wt=`${zi}@${2}:${jr}:`,Ps={name:jr,logger:"error"},Us={database:":memory:"},Ms="crypto",Hi="client_ed25519_seed",js=Se.ONE_DAY,Bs="keychain",Fs="0.3",zs="messages",Hs="0.3",$s=Se.SIX_HOURS,Ks="publisher",Gs="irn",Vs="error",Ys="wss://relay.walletconnect.com",Ws="relayer",qt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error"},qs="_subscription",Ut={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Xs=Se.ONE_SECOND,el={database:":memory:"},Js="2.0.0",ks="0.3",Ot={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync"},tl=Se.THIRTY_DAYS,Zs="subscription",Qs="0.3",ea=Se.FIVE_SECONDS*1e3,ta="pairing",ra="0.3",rl=Se.THIRTY_DAYS,Xt={wc_pairingDelete:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Se.ONE_DAY,prompt:!1,tag:0},res:{ttl:Se.ONE_DAY,prompt:!1,tag:0}}},lt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ia="history",na="0.3",sa="expirer",ut={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},aa="0.3",il=Se.ONE_DAY;class oa{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=Bs,this.version=Fs,this.initialized=!1,this.storagePrefix=wt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:o}=Te("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(o)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Ts(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xs(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ca{constructor(e,r,i){this.core=e,this.logger=r,this.name=Ms,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),o=Qn(n);return Zn(o.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=_h();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const o=await this.getClientSeed(),u=Qn(o),c=Ni();return await Df(c,n,js,u)},this.generateSharedKey=(n,o,u)=>{this.isInitialized();const c=this.getPrivateKey(n),f=ph(c,o);return this.setSymKey(f,u)},this.setSymKey=async(n,o)=>{this.isInitialized();const u=o||vh(n);return await this.keychain.set(u,n),u},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,o,u)=>{this.isInitialized();const c=Es(u),f=ui(o);if(ws(c)){const A=c.senderPublicKey,m=c.receiverPublicKey;n=await this.generateSharedKey(A,m)}const d=this.getSymKey(n),{type:g,senderPublicKey:D}=c;return bh({type:g,symKey:d,message:f,senderPublicKey:D})},this.decode=async(n,o,u)=>{this.isInitialized();const c=mh(o,u);if(ws(c)){const g=c.receiverPublicKey,D=c.senderPublicKey;n=await this.generateSharedKey(g,D)}const f=this.getSymKey(n),d=Eh({symKey:f,encoded:o});return yn(d)},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.keychain=i||new oa(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}getPayloadType(e){const r=Pi(e);return hr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Hi)}catch{e=Ni(),await this.keychain.set(Hi,e)}return nt(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ua extends tc{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=zs,this.version=Hs,this.initialized=!1,this.storagePrefix=wt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const o=Ur(n);let u=this.messages.get(i);return typeof u>"u"&&(u={}),typeof u[o]<"u"||(u[o]=n,this.messages.set(i,u),await this.persist()),o},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const o=this.get(i),u=Ur(n);return typeof o[u]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=xe.generateChildLogger(e,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Ts(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xs(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}const nl="PARSE_ERROR",sl="INVALID_REQUEST",al="METHOD_NOT_FOUND",ol="INVALID_PARAMS",fa="INTERNAL_ERROR",$i="SERVER_ERROR",cl=[-32700,-32600,-32601,-32602,-32603],gr={[nl]:{code:-32700,message:"Parse error"},[sl]:{code:-32600,message:"Invalid Request"},[al]:{code:-32601,message:"Method not found"},[ol]:{code:-32602,message:"Invalid params"},[fa]:{code:-32603,message:"Internal error"},[$i]:{code:-32e3,message:"Server error"}},ha=$i;function ul(t){return cl.includes(t)}function la(t){return Object.keys(gr).includes(t)?gr[t]:gr[ha]}function fl(t){const e=Object.values(gr).find(r=>r.code===t);return e||gr[ha]}function hl(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var da={},Tt={};Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.isBrowserCryptoAvailable=Tt.getSubtleCrypto=Tt.getBrowerCrypto=void 0;function Ki(){return Z?.crypto||Z?.msCrypto||{}}Tt.getBrowerCrypto=Ki;function ga(){const t=Ki();return t.subtle||t.webkitSubtle}Tt.getSubtleCrypto=ga;function ll(){return!!Ki()&&!!ga()}Tt.isBrowserCryptoAvailable=ll;var xt={};Object.defineProperty(xt,"__esModule",{value:!0}),xt.isBrowser=xt.isNode=xt.isReactNative=void 0;function _a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}xt.isReactNative=_a;function pa(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}xt.isNode=pa;function dl(){return!_a()&&!pa()}xt.isBrowser=dl,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,o,u){u===void 0&&(u=o),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[o]}})}:function(i,n,o,u){u===void 0&&(u=o),i[u]=n[o]}),r=Z&&Z.__exportStar||function(i,n){for(var o in i)o!=="default"&&!n.hasOwnProperty(o)&&e(n,i,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(Tt,t),r(xt,t)}(da);function gl(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function Gi(t,e,r){return{id:r||gl(),jsonrpc:"2.0",method:t,params:e}}function va(t,e){return{id:t,jsonrpc:"2.0",result:e}}function ya(t,e,r){return{id:t,jsonrpc:"2.0",error:_l(e,r)}}function _l(t,e){return typeof t>"u"?la(fa):(typeof t=="string"&&(t=Object.assign(Object.assign({},la($i)),{message:t})),typeof e<"u"&&(t.data=e),ul(t.code)&&(t=fl(t.code)),t)}class pl{}class vl extends pl{constructor(){super()}}class yl extends vl{constructor(e){super()}}const bl="^wss?:";function El(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function wl(t,e){const r=El(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function ba(t){return wl(t,bl)}function ml(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Ea(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function wa(t){return Ea(t)&&"method"in t}function ma(t){return Ea(t)&&(Da(t)||Br(t))}function Da(t){return"result"in t}function Br(t){return"error"in t}class Dl extends yl{constructor(e){super(e),this.events=new pt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Gi(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(o){n(o)}this.events.on(`${e.id}`,o=>{Br(o)?n(o.error):i(o.result)});try{await this.connection.send(e,r)}catch(o){n(o)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ma(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const Sa=10,Sl=typeof global.WebSocket<"u"?global.WebSocket:require("ws");class Ol{constructor(e){if(this.url=e,this.events=new pt.EventEmitter,this.registering=!1,!ba(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ui(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!ba(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",o=>{this.resetMaxListeners(),n(o)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=da.isReactNative()?void 0:{rejectUnauthorized:!ml(e)},o=new Sl(e,[],n);o.onopen=()=>{this.onOpen(o),r(o)},o.onerror=u=>{const c=this.parseError(u.error);this.events.emit("register_error",c),this.onClose(),i(c)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),e.onerror=r=>{const i=this.parseError(r.error);this.events.emit("error",i)},this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?yn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),o=ya(e,n);this.events.emit("payload",o)}parseError(e,r=this.url){return hl(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Sa&&this.events.setMaxListeners(Sa)}}class Tl extends rc{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new pt.EventEmitter,this.name=Ks,this.queue=new Map,this.publish=async(i,n,o)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:o}});try{const u=o?.ttl||$s,c=ji(o),f=o?.prompt||!1,d=o?.tag||0,g={topic:i,message:n,opts:{ttl:u,relay:c,prompt:f,tag:d}},D=Ur(n);this.queue.set(D,g),await this.rpcPublish(i,n,u,c,f,d),this.onPublish(D,g),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:o}})}catch(u){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(u),u}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,o,u){var c,f,d,g;const D={method:Bi(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:o,tag:u}};return Mr((c=D.params)==null?void 0:c.prompt)&&((f=D.params)==null||delete f.prompt),Mr((d=D.params)==null?void 0:d.tag)&&((g=D.params)==null||delete g.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.provider.request(D)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:{ttl:n,relay:o,prompt:u,tag:c}}=e,f=Ur(i);await this.rpcPublish(r,i,n,o,u,c),this.onPublish(f,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(nr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class xl{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(o=>o!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Rl=Object.defineProperty,Il=Object.defineProperties,Al=Object.getOwnPropertyDescriptors,Oa=Object.getOwnPropertySymbols,Cl=Object.prototype.hasOwnProperty,Ll=Object.prototype.propertyIsEnumerable,Ta=(t,e,r)=>e in t?Rl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fr=(t,e)=>{for(var r in e||(e={}))Cl.call(e,r)&&Ta(t,r,e[r]);if(Oa)for(var r of Oa(e))Ll.call(e,r)&&Ta(t,r,e[r]);return t},Vi=(t,e)=>Il(t,Al(e));class xa extends sc{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new xl,this.events=new pt.EventEmitter,this.name=Zs,this.version=Qs,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),await this.reset(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const o=ji(n),u={topic:i,relay:o};this.pending.set(i,u);const c=await this.rpcSubscribe(i,o);return this.onSubscribe(c,u),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}},this.unsubscribe=async(i,n)=>{this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,o)=>{const u=new Se.Watch;u.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),u.stop(this.pendingSubscriptionWatchLabel),n(!0)),u.elapsed(this.pendingSubscriptionWatchLabel)>=ea&&(clearInterval(c),u.stop(this.pendingSubscriptionWatchLabel),o(!1))},this.pendingSubInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=ji(i);await this.rpcUnsubscribe(e,r,n);const o=dr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,o),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:Bi(r.protocol).subscribe,params:{topic:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),await this.relayer.provider.request(i)}rpcUnsubscribe(e,r,i){const n={method:Bi(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,r){this.setSubscription(e,Vi(Fr({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Vi(Fr({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Fr({},r)),this.topicMap.set(r.topic,e),this.events.emit(Ot.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Ot.deleted,Vi(Fr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ot.sync)}async reset(){!this.cached.length||await Promise.all(this.cached.map(async e=>await this.resubscribe(e)))}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:i}=e,n={topic:r,relay:i};this.pending.set(n.topic,n);const o=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(o,n)}}async onConnect(){await this.reset(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(nr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.provider.on(Ut.connect,async()=>{await this.onConnect()}),this.relayer.provider.on(Ut.disconnect,()=>{this.onDisconnect()}),this.events.on(Ot.created,async e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Ot.deleted,async e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Nl=Object.defineProperty,Ra=Object.getOwnPropertySymbols,Pl=Object.prototype.hasOwnProperty,Ul=Object.prototype.propertyIsEnumerable,Ia=(t,e,r)=>e in t?Nl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ml=(t,e)=>{for(var r in e||(e={}))Pl.call(e,r)&&Ia(t,r,e[r]);if(Ra)for(var r of Ra(e))Ul.call(e,r)&&Ia(t,r,e[r]);return t};class Aa extends ic{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new pt.EventEmitter,this.name=Ws,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?xe.generateChildLogger(e.logger,this.name):Xi(xe.getDefaultLoggerOptions({level:e.logger||Vs})),this.messages=new ua(this.logger,e.core),this.subscriber=new xa(this,this.logger),this.publisher=new Tl(this,this.logger),this.relayUrl=e?.relayUrl||Ys,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized");const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=this.createProvider(e),await Promise.all([this.messages.init(),this.provider.connect(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){return this.isInitialized(),await this.subscriber.subscribe(e,r)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}createProvider(e){return new Dl(new Ol(Uh({sdkVersion:Js,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),wa(e)){if(!e.method.endsWith(qs))return;const r=e.params,{topic:i,message:n}=r.data,o={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ml({type:"event",event:r.id},o)),this.events.emit(r.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(qt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=va(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(Ut.payload,e=>this.onProviderPayload(e)),this.provider.on(Ut.connect,()=>{this.events.emit(qt.connect)}),this.provider.on(Ut.disconnect,()=>{this.events.emit(qt.disconnect),setTimeout(()=>{this.provider.connect()},Se.toMiliseconds(Xs))}),this.provider.on(Ut.error,e=>this.events.emit(qt.error,e))}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Yi={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,o=2,u=9007199254740991,c="[object Arguments]",f="[object Array]",d="[object AsyncFunction]",g="[object Boolean]",D="[object Date]",A="[object Error]",m="[object Function]",R="[object GeneratorFunction]",j="[object Map]",C="[object Number]",$="[object Null]",w="[object Object]",x="[object Promise]",p="[object Proxy]",y="[object RegExp]",v="[object Set]",s="[object String]",l="[object Symbol]",U="[object Undefined]",H="[object WeakMap]",q="[object ArrayBuffer]",J="[object DataView]",k="[object Float32Array]",S="[object Float64Array]",I="[object Int8Array]",G="[object Int16Array]",Y="[object Int32Array]",N="[object Uint8Array]",P="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",ie=/[\\^$.*+?()[\]{}|]/g,F=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,W={};W[k]=W[S]=W[I]=W[G]=W[Y]=W[N]=W[P]=W[M]=W[B]=!0,W[c]=W[f]=W[q]=W[g]=W[J]=W[D]=W[A]=W[m]=W[j]=W[C]=W[w]=W[y]=W[v]=W[s]=W[H]=!1;var oe=typeof Z=="object"&&Z&&Z.Object===Object&&Z,T=typeof self=="object"&&self&&self.Object===Object&&self,O=oe||T||Function("return this")(),b=e&&!e.nodeType&&e,a=b&&!0&&t&&!t.nodeType&&t,_=a&&a.exports===b,z=_&&oe.process,K=function(){try{return z&&z.binding&&z.binding("util")}catch{}}(),he=K&&K.isTypedArray;function ve(h,E){for(var L=-1,V=h==null?0:h.length,Re=0,ne=[];++L<V;){var Pe=h[L];E(Pe,L,h)&&(ne[Re++]=Pe)}return ne}function de(h,E){for(var L=-1,V=E.length,Re=h.length;++L<V;)h[Re+L]=E[L];return h}function Ee(h,E){for(var L=-1,V=h==null?0:h.length;++L<V;)if(E(h[L],L,h))return!0;return!1}function Ue(h,E){for(var L=-1,V=Array(h);++L<h;)V[L]=E(L);return V}function Ce(h){return function(E){return h(E)}}function pe(h,E){return h.has(E)}function ge(h,E){return h?.[E]}function le(h){var E=-1,L=Array(h.size);return h.forEach(function(V,Re){L[++E]=[Re,V]}),L}function ue(h,E){return function(L){return h(E(L))}}function ce(h){var E=-1,L=Array(h.size);return h.forEach(function(V){L[++E]=V}),L}var ae=Array.prototype,se=Function.prototype,te=Object.prototype,fe=O["__core-js_shared__"],_e=se.toString,re=te.hasOwnProperty,ye=function(){var h=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),be=te.toString,me=RegExp("^"+_e.call(re).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=_?O.Buffer:void 0,we=O.Symbol,dt=O.Uint8Array,yt=te.propertyIsEnumerable,Rt=ae.splice,ot=we?we.toStringTag:void 0,Mt=Object.getOwnPropertySymbols,_r=De?De.isBuffer:void 0,Hr=ue(Object.keys,Object),Me=Jt(O,"DataView"),Le=Jt(O,"Map"),je=Jt(O,"Promise"),Be=Jt(O,"Set"),Fe=Jt(O,"WeakMap"),Ne=Jt(Object,"create"),Ge=Bt(Me),Ve=Bt(Le),Ye=Bt(je),We=Bt(Be),qe=Bt(Fe),He=we?we.prototype:void 0,ze=He?He.valueOf:void 0;function Ie(h){var E=-1,L=h==null?0:h.length;for(this.clear();++E<L;){var V=h[E];this.set(V[0],V[1])}}function Xe(){this.__data__=Ne?Ne(null):{},this.size=0}function Je(h){var E=this.has(h)&&delete this.__data__[h];return this.size-=E?1:0,E}function Vl(h){var E=this.__data__;if(Ne){var L=E[h];return L===i?void 0:L}return re.call(E,h)?E[h]:void 0}function Yl(h){var E=this.__data__;return Ne?E[h]!==void 0:re.call(E,h)}function Wl(h,E){var L=this.__data__;return this.size+=this.has(h)?0:1,L[h]=Ne&&E===void 0?i:E,this}Ie.prototype.clear=Xe,Ie.prototype.delete=Je,Ie.prototype.get=Vl,Ie.prototype.has=Yl,Ie.prototype.set=Wl;function mt(h){var E=-1,L=h==null?0:h.length;for(this.clear();++E<L;){var V=h[E];this.set(V[0],V[1])}}function ql(){this.__data__=[],this.size=0}function Xl(h){var E=this.__data__,L=Kr(E,h);if(L<0)return!1;var V=E.length-1;return L==V?E.pop():Rt.call(E,L,1),--this.size,!0}function Jl(h){var E=this.__data__,L=Kr(E,h);return L<0?void 0:E[L][1]}function kl(h){return Kr(this.__data__,h)>-1}function Zl(h,E){var L=this.__data__,V=Kr(L,h);return V<0?(++this.size,L.push([h,E])):L[V][1]=E,this}mt.prototype.clear=ql,mt.prototype.delete=Xl,mt.prototype.get=Jl,mt.prototype.has=kl,mt.prototype.set=Zl;function jt(h){var E=-1,L=h==null?0:h.length;for(this.clear();++E<L;){var V=h[E];this.set(V[0],V[1])}}function Ql(){this.size=0,this.__data__={hash:new Ie,map:new(Le||mt),string:new Ie}}function ed(h){var E=Gr(this,h).delete(h);return this.size-=E?1:0,E}function td(h){return Gr(this,h).get(h)}function rd(h){return Gr(this,h).has(h)}function id(h,E){var L=Gr(this,h),V=L.size;return L.set(h,E),this.size+=L.size==V?0:1,this}jt.prototype.clear=Ql,jt.prototype.delete=ed,jt.prototype.get=td,jt.prototype.has=rd,jt.prototype.set=id;function $r(h){var E=-1,L=h==null?0:h.length;for(this.__data__=new jt;++E<L;)this.add(h[E])}function nd(h){return this.__data__.set(h,i),this}function sd(h){return this.__data__.has(h)}$r.prototype.add=$r.prototype.push=nd,$r.prototype.has=sd;function It(h){var E=this.__data__=new mt(h);this.size=E.size}function ad(){this.__data__=new mt,this.size=0}function od(h){var E=this.__data__,L=E.delete(h);return this.size=E.size,L}function cd(h){return this.__data__.get(h)}function ud(h){return this.__data__.has(h)}function fd(h,E){var L=this.__data__;if(L instanceof mt){var V=L.__data__;if(!Le||V.length<r-1)return V.push([h,E]),this.size=++L.size,this;L=this.__data__=new jt(V)}return L.set(h,E),this.size=L.size,this}It.prototype.clear=ad,It.prototype.delete=od,It.prototype.get=cd,It.prototype.has=ud,It.prototype.set=fd;function hd(h,E){var L=Vr(h),V=!L&&Td(h),Re=!L&&!V&&Wi(h),ne=!L&&!V&&!Re&&Xa(h),Pe=L||V||Re||ne,ke=Pe?Ue(h.length,String):[],Qe=ke.length;for(var Ae in h)(E||re.call(h,Ae))&&!(Pe&&(Ae=="length"||Re&&(Ae=="offset"||Ae=="parent")||ne&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||wd(Ae,Qe)))&&ke.push(Ae);return ke}function Kr(h,E){for(var L=h.length;L--;)if(Va(h[L][0],E))return L;return-1}function ld(h,E,L){var V=E(h);return Vr(h)?V:de(V,L(h))}function pr(h){return h==null?h===void 0?U:$:ot&&ot in Object(h)?bd(h):Od(h)}function Ha(h){return vr(h)&&pr(h)==c}function $a(h,E,L,V,Re){return h===E?!0:h==null||E==null||!vr(h)&&!vr(E)?h!==h&&E!==E:dd(h,E,L,V,$a,Re)}function dd(h,E,L,V,Re,ne){var Pe=Vr(h),ke=Vr(E),Qe=Pe?f:At(h),Ae=ke?f:At(E);Qe=Qe==c?w:Qe,Ae=Ae==c?w:Ae;var ct=Qe==w,gt=Ae==w,tt=Qe==Ae;if(tt&&Wi(h)){if(!Wi(E))return!1;Pe=!0,ct=!1}if(tt&&!ct)return ne||(ne=new It),Pe||Xa(h)?Ka(h,E,L,V,Re,ne):vd(h,E,Qe,L,V,Re,ne);if(!(L&n)){var ft=ct&&re.call(h,"__wrapped__"),ht=gt&&re.call(E,"__wrapped__");if(ft||ht){var Ct=ft?h.value():h,Dt=ht?E.value():E;return ne||(ne=new It),Re(Ct,Dt,L,V,ne)}}return tt?(ne||(ne=new It),yd(h,E,L,V,Re,ne)):!1}function gd(h){if(!qa(h)||Dd(h))return!1;var E=Ya(h)?me:F;return E.test(Bt(h))}function _d(h){return vr(h)&&Wa(h.length)&&!!W[pr(h)]}function pd(h){if(!Sd(h))return Hr(h);var E=[];for(var L in Object(h))re.call(h,L)&&L!="constructor"&&E.push(L);return E}function Ka(h,E,L,V,Re,ne){var Pe=L&n,ke=h.length,Qe=E.length;if(ke!=Qe&&!(Pe&&Qe>ke))return!1;var Ae=ne.get(h);if(Ae&&ne.get(E))return Ae==E;var ct=-1,gt=!0,tt=L&o?new $r:void 0;for(ne.set(h,E),ne.set(E,h);++ct<ke;){var ft=h[ct],ht=E[ct];if(V)var Ct=Pe?V(ht,ft,ct,E,h,ne):V(ft,ht,ct,h,E,ne);if(Ct!==void 0){if(Ct)continue;gt=!1;break}if(tt){if(!Ee(E,function(Dt,Ft){if(!pe(tt,Ft)&&(ft===Dt||Re(ft,Dt,L,V,ne)))return tt.push(Ft)})){gt=!1;break}}else if(!(ft===ht||Re(ft,ht,L,V,ne))){gt=!1;break}}return ne.delete(h),ne.delete(E),gt}function vd(h,E,L,V,Re,ne,Pe){switch(L){case J:if(h.byteLength!=E.byteLength||h.byteOffset!=E.byteOffset)return!1;h=h.buffer,E=E.buffer;case q:return!(h.byteLength!=E.byteLength||!ne(new dt(h),new dt(E)));case g:case D:case C:return Va(+h,+E);case A:return h.name==E.name&&h.message==E.message;case y:case s:return h==E+"";case j:var ke=le;case v:var Qe=V&n;if(ke||(ke=ce),h.size!=E.size&&!Qe)return!1;var Ae=Pe.get(h);if(Ae)return Ae==E;V|=o,Pe.set(h,E);var ct=Ka(ke(h),ke(E),V,Re,ne,Pe);return Pe.delete(h),ct;case l:if(ze)return ze.call(h)==ze.call(E)}return!1}function yd(h,E,L,V,Re,ne){var Pe=L&n,ke=Ga(h),Qe=ke.length,Ae=Ga(E),ct=Ae.length;if(Qe!=ct&&!Pe)return!1;for(var gt=Qe;gt--;){var tt=ke[gt];if(!(Pe?tt in E:re.call(E,tt)))return!1}var ft=ne.get(h);if(ft&&ne.get(E))return ft==E;var ht=!0;ne.set(h,E),ne.set(E,h);for(var Ct=Pe;++gt<Qe;){tt=ke[gt];var Dt=h[tt],Ft=E[tt];if(V)var Ja=Pe?V(Ft,Dt,tt,E,h,ne):V(Dt,Ft,tt,h,E,ne);if(!(Ja===void 0?Dt===Ft||Re(Dt,Ft,L,V,ne):Ja)){ht=!1;break}Ct||(Ct=tt=="constructor")}if(ht&&!Ct){var Yr=h.constructor,Wr=E.constructor;Yr!=Wr&&"constructor"in h&&"constructor"in E&&!(typeof Yr=="function"&&Yr instanceof Yr&&typeof Wr=="function"&&Wr instanceof Wr)&&(ht=!1)}return ne.delete(h),ne.delete(E),ht}function Ga(h){return ld(h,Id,Ed)}function Gr(h,E){var L=h.__data__;return md(E)?L[typeof E=="string"?"string":"hash"]:L.map}function Jt(h,E){var L=ge(h,E);return gd(L)?L:void 0}function bd(h){var E=re.call(h,ot),L=h[ot];try{h[ot]=void 0;var V=!0}catch{}var Re=be.call(h);return V&&(E?h[ot]=L:delete h[ot]),Re}var Ed=Mt?function(h){return h==null?[]:(h=Object(h),ve(Mt(h),function(E){return yt.call(h,E)}))}:Ad,At=pr;(Me&&At(new Me(new ArrayBuffer(1)))!=J||Le&&At(new Le)!=j||je&&At(je.resolve())!=x||Be&&At(new Be)!=v||Fe&&At(new Fe)!=H)&&(At=function(h){var E=pr(h),L=E==w?h.constructor:void 0,V=L?Bt(L):"";if(V)switch(V){case Ge:return J;case Ve:return j;case Ye:return x;case We:return v;case qe:return H}return E});function wd(h,E){return E=E??u,!!E&&(typeof h=="number"||Q.test(h))&&h>-1&&h%1==0&&h<E}function md(h){var E=typeof h;return E=="string"||E=="number"||E=="symbol"||E=="boolean"?h!=="__proto__":h===null}function Dd(h){return!!ye&&ye in h}function Sd(h){var E=h&&h.constructor,L=typeof E=="function"&&E.prototype||te;return h===L}function Od(h){return be.call(h)}function Bt(h){if(h!=null){try{return _e.call(h)}catch{}try{return h+""}catch{}}return""}function Va(h,E){return h===E||h!==h&&E!==E}var Td=Ha(function(){return arguments}())?Ha:function(h){return vr(h)&&re.call(h,"callee")&&!yt.call(h,"callee")},Vr=Array.isArray;function xd(h){return h!=null&&Wa(h.length)&&!Ya(h)}var Wi=_r||Cd;function Rd(h,E){return $a(h,E)}function Ya(h){if(!qa(h))return!1;var E=pr(h);return E==m||E==R||E==d||E==p}function Wa(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=u}function qa(h){var E=typeof h;return h!=null&&(E=="object"||E=="function")}function vr(h){return h!=null&&typeof h=="object"}var Xa=he?Ce(he):_d;function Id(h){return xd(h)?hd(h):pd(h)}function Ad(){return[]}function Cd(){return!1}t.exports=Rd})(Yi,Yi.exports);var jl=Yi.exports,Bl=Object.defineProperty,Ca=Object.getOwnPropertySymbols,Fl=Object.prototype.hasOwnProperty,zl=Object.prototype.propertyIsEnumerable,La=(t,e,r)=>e in t?Bl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Na=(t,e)=>{for(var r in e||(e={}))Fl.call(e,r)&&La(t,r,e[r]);if(Ca)for(var r of Ca(e))zl.call(e,r)&&La(t,r,e[r]);return t};class Pa extends nc{constructor(e,r,i,n=wt,o=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=ks,this.cached=[],this.initialized=!1,this.storagePrefix=wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(u=>{Zh(u)?this.map.set(u.id,u):Qh(u)?this.map.set(u.topic,u):this.getKey&&u!==null&&!Mr(u)&&this.map.set(this.getKey(u),u)}),this.cached=[],this.initialized=!0)},this.set=async(u,c)=>{this.isInitialized(),this.map.has(u)?await this.update(u,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:u,value:c}),this.map.set(u,c),await this.persist())},this.get=u=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:u}),this.getData(u)),this.getAll=u=>(this.isInitialized(),u?this.values.filter(c=>Object.keys(u).every(f=>jl(c[f],u[f]))):this.values),this.update=async(u,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:u,update:c});const f=Na(Na({},this.getData(u)),c);this.map.set(u,f),await this.persist()},this.delete=async(u,c)=>{this.isInitialized(),this.map.has(u)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:u,reason:c}),this.map.delete(u),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=o}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ua{constructor(e,r){this.core=e,this.logger=r,this.name=ta,this.version=ra,this.events=new pt,this.initialized=!1,this.storagePrefix=wt,this.ignoredPayloadTypes=[Wt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Ni(),n=await this.core.crypto.setSymKey(i),o=Ui(Se.FIVE_MINUTES),u={protocol:Gs},c={topic:n,expiry:o,relay:u,active:!1},f=qh({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:u});return await this.pairings.set(n,c),await this.core.relayer.subscribe(n),this.core.expirer.set(n,o),{topic:n,uri:f}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:o,relay:u}=Yh(i.uri),c=Ui(Se.FIVE_MINUTES),f={topic:n,relay:u,expiry:c,active:!1};return await this.pairings.set(n,f),await this.core.crypto.setSymKey(o,n),await this.core.relayer.subscribe(n,{relay:u}),this.core.expirer.set(n,c),i.activatePairing&&await this.activate({topic:n}),f},this.activate=async({topic:i})=>{this.isInitialized();const n=Ui(Se.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const o=await this.sendRequest(n,"wc_pairingPing",{}),{done:u,resolve:c,reject:f}=Mh();this.events.once(Mi("pairing_ping",o),({error:d})=>{d?f(d):c()}),await u()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",dr("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,o)=>{const u=Gi(n,o),c=await this.core.crypto.encode(i,u),f=Xt[n].req;return this.core.history.set(i,u),await this.core.relayer.publish(i,c,f),u.id},this.sendResult=async(i,n,o)=>{const u=va(i,o),c=await this.core.crypto.encode(n,u),f=await this.core.history.get(n,i),d=Xt[f.request.method].res;await this.core.relayer.publish(n,c,d),await this.core.history.resolve(u)},this.sendError=async(i,n,o)=>{const u=ya(i,o),c=await this.core.crypto.encode(n,u),f=await this.core.history.get(n,i),d=Xt[f.request.method]?Xt[f.request.method].res:Xt.unregistered_method.res;await this.core.relayer.publish(n,c,d),await this.core.history.resolve(u)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,dr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Rs(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:o}=i;switch(o.method){case"wc_pairingPing":return this.onPairingPingRequest(n,o);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,o);default:return this.onUnknownRpcMethodRequest(n,o)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:o}=i,u=(await this.core.history.get(n,o.id)).request.method;switch(u){case"wc_pairingPing":return this.onPairingPingResponse(n,o);default:return this.onUnknownRpcMethodResponse(u)}},this.onPairingPingRequest=async(i,n)=>{const{id:o}=n;try{this.isValidPing({topic:i}),await this.sendResult(o,i,!0),this.events.emit("pairing_ping",{id:o,topic:i})}catch(u){await this.sendError(o,i,u),this.logger.error(u)}},this.onPairingPingResponse=(i,n)=>{const{id:o}=n;setTimeout(()=>{Da(n)?this.events.emit(Mi("pairing_ping",o),{}):Br(n)&&this.events.emit(Mi("pairing_ping",o),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:i}),await this.sendResult(o,i,!0),await this.deletePairing(i),this.events.emit("pairing_delete",{id:o,topic:i})}catch(u){await this.sendError(o,i,u),this.logger.error(u)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:o,method:u}=n;try{if(this.registeredMethods.includes(u))return;const c=dr("WC_METHOD_UNSUPPORTED",u);await this.sendError(o,i,c),this.logger.error(c)}catch(c){await this.sendError(o,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(dr("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!Fi(i)){const{message:n}=Te("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!kh(i.uri)){const{message:n}=Te("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!Fi(i)){const{message:o}=Te("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!Fi(i)){const{message:o}=Te("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Ls(i,!1)){const{message:n}=Te("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=Te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Rs(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=Te("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.pairings=new Pa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(qt.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);wa(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):ma(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(ut.expired,async e=>{const{topic:r}=Fh(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Ma extends ec{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new pt.EventEmitter,this.name=ia,this.version=na,this.cached=[],this.initialized=!1,this.storagePrefix=wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,o)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:o}),this.records.has(n.id))return;const u={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:o};this.records.set(u.id,u),this.events.emit(lt.created,u)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Br(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(lt.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(o=>{if(o.topic===i){if(typeof n<"u"&&o.id!==n)return;this.records.delete(o.id),this.events.emit(lt.deleted,o)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:Gi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(lt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(lt.created,e=>{const r=lt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(lt.updated,e=>{const r=lt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(lt.deleted,e=>{const r=lt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ja extends ac{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new pt.EventEmitter,this.name=sa,this.version=aa,this.cached=[],this.initialized=!1,this.storagePrefix=wt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const o=this.formatTarget(i),u={target:o,expiry:n};this.expirations.set(o,u),this.checkExpiry(o,u),this.events.emit(ut.created,{target:o,expiration:u})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{this.isInitialized();const n=this.formatTarget(i);if(this.has(n)){const o=this.getExpiration(n);this.expirations.delete(n),this.events.emit(ut.deleted,{target:n,expiration:o})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return jh(e);if(typeof e=="number")return Bh(e);const{message:r}=Te("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ut.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Se.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(ut.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(nr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ut.created,e=>{const r=ut.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ut.expired,e=>{const r=ut.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ut.deleted,e=>{const r=ut.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Hl=Object.defineProperty,Ba=Object.getOwnPropertySymbols,$l=Object.prototype.hasOwnProperty,Kl=Object.prototype.propertyIsEnumerable,Fa=(t,e,r)=>e in t?Hl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,za=(t,e)=>{for(var r in e||(e={}))$l.call(e,r)&&Fa(t,r,e[r]);if(Ba)for(var r of Ba(e))Kl.call(e,r)&&Fa(t,r,e[r]);return t};class zr extends Qo{constructor(e){super(e),this.protocol=zi,this.version=Ns,this.name=jr,this.events=new pt.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Xi(xe.getDefaultLoggerOptions({level:e?.logger||Ps.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new nr.HeartBeat,this.crypto=new ca(this,this.logger,e?.keychain),this.history=new Ma(this,this.logger),this.expirer=new ja(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Fo(za(za({},Us),e?.storageOptions)),this.relayer=new Aa({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId}),this.pairing=new Ua(this,this.logger)}static async init(e){const r=new zr(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(e){throw this.logger.warn(`Core Initilization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Gl=zr;X.CORE_CONTEXT=jr,X.CORE_DEFAULT=Ps,X.CORE_PROTOCOL=zi,X.CORE_STORAGE_OPTIONS=Us,X.CORE_STORAGE_PREFIX=wt,X.CORE_VERSION=Ns,X.CRYPTO_CLIENT_SEED=Hi,X.CRYPTO_CONTEXT=Ms,X.CRYPTO_JWT_TTL=js,X.Core=Gl,X.Crypto=ca,X.EXPIRER_CONTEXT=sa,X.EXPIRER_DEFAULT_TTL=il,X.EXPIRER_EVENTS=ut,X.EXPIRER_STORAGE_VERSION=aa,X.Expirer=ja,X.HISTORY_CONTEXT=ia,X.HISTORY_EVENTS=lt,X.HISTORY_STORAGE_VERSION=na,X.JsonRpcHistory=Ma,X.KEYCHAIN_CONTEXT=Bs,X.KEYCHAIN_STORAGE_VERSION=Fs,X.KeyChain=oa,X.MESSAGES_CONTEXT=zs,X.MESSAGES_STORAGE_VERSION=Hs,X.MessageTracker=ua,X.PAIRING_CONTEXT=ta,X.PAIRING_DEFAULT_TTL=rl,X.PAIRING_RPC_OPTS=Xt,X.PAIRING_STORAGE_VERSION=ra,X.PENDING_SUB_RESOLUTION_TIMEOUT=ea,X.PUBLISHER_CONTEXT=Ks,X.PUBLISHER_DEFAULT_TTL=$s,X.Pairing=Ua,X.RELAYER_CONTEXT=Ws,X.RELAYER_DEFAULT_LOGGER=Vs,X.RELAYER_DEFAULT_PROTOCOL=Gs,X.RELAYER_DEFAULT_RELAY_URL=Ys,X.RELAYER_EVENTS=qt,X.RELAYER_PROVIDER_EVENTS=Ut,X.RELAYER_RECONNECT_TIMEOUT=Xs,X.RELAYER_SDK_VERSION=Js,X.RELAYER_STORAGE_OPTIONS=el,X.RELAYER_SUBSCRIBER_SUFFIX=qs,X.Relayer=Aa,X.STORE_STORAGE_VERSION=ks,X.SUBSCRIBER_CONTEXT=Zs,X.SUBSCRIBER_DEFAULT_TTL=tl,X.SUBSCRIBER_EVENTS=Ot,X.SUBSCRIBER_STORAGE_VERSION=Qs,X.Store=Pa,X.Subscriber=xa,X.default=zr,Object.defineProperty(X,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
